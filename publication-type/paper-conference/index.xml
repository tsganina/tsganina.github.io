<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Paper-Conference | Групповой проект</title>
    <link>http://localhost:1313/publication-type/paper-conference/</link>
      <atom:link href="http://localhost:1313/publication-type/paper-conference/index.xml" rel="self" type="application/rss+xml" />
    <description>Paper-Conference</description>
    <generator>Hugo Blox Builder (https://hugoblox.com)</generator><language>ru-ru</language><lastBuildDate>Fri, 16 May 2025 00:00:00 +0000</lastBuildDate>
    <image>
      <url>http://localhost:1313/media/icon_hu991375cb18ef50f275a94f646dee4b07_32991_512x512_fill_lanczos_center_3.png</url>
      <title>Paper-Conference</title>
      <link>http://localhost:1313/publication-type/paper-conference/</link>
    </image>
    
    <item>
      <title>Четвертый этап проекта</title>
      <link>http://localhost:1313/publication/4step/</link>
      <pubDate>Fri, 16 May 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/publication/4step/</guid>
      <description>&lt;h1 id=&#34;введение&#34;&gt;Введение&lt;/h1&gt;
&lt;h2 id=&#34;цель-проекта&#34;&gt;Цель проекта&lt;/h2&gt;
&lt;p&gt;Разработать и проанализировать модель на основе решеточного уравнения Больцмана для описания течений газа.&lt;/p&gt;
&lt;h2 id=&#34;цель-и-задачи-четвертого-этапа-проекта&#34;&gt;Цель и задачи четвертого этапа проекта&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Главная цель:&lt;/strong&gt; провести комплексный анализ полученных результатов моделирования, оценить качество реализации модели HPP, обсудить итоги работы в команде и представить проект на защите.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Задачи этапа:&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Анализировать результаты тестирования модели&lt;/li&gt;
&lt;li&gt;Обсудить в команде итоги работы&lt;/li&gt;
&lt;li&gt;Оценить качество реализации проекта, в частности, написанного кода&lt;/li&gt;
&lt;li&gt;Подготовить материалы для защиты проекта&lt;/li&gt;
&lt;li&gt;Провести самооценку деятельности&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;актуальность&#34;&gt;Актуальность&lt;/h2&gt;
&lt;p&gt;В современных научных и инженерных задачах моделирование сложных физических процессов становится всё более востребованным инструментом. Одной из таких задач является моделирование течения газа, где традиционные методы требуют значительных вычислительных ресурсов и часто оказываются непрактичными для задач большого масштаба или с высокой степенью детализации. В этом контексте решеточные методы (LGA и LBE) приобретают особую актуальность, так как позволяют упростить вычисления, сохраняя при этом физическую достоверность моделируемых процессов [@1].&lt;/p&gt;
&lt;p&gt;Наш проект был посвящён построению и анализу модели на основе решёточного уравнения Больцмана (модель HPP). Работа над проектом велась в составе команды №4 (Абакумова Олеся, Астраханцева Анастасия, Ганина Таисия, Ибатулина Дарья). Проект был разбит на три этапа, каждый из которых имел свои задачи и результаты. В данном отчёте подробно рассмотрим четвертый этап – коллективное обсуждение итогов и самооценку нашей деятельности.&lt;/p&gt;
&lt;h1 id=&#34;основная-часть&#34;&gt;Основная часть&lt;/h1&gt;
&lt;h2 id=&#34;итоги-трёх-этапов-проекта&#34;&gt;Итоги трёх этапов проекта&lt;/h2&gt;
&lt;h3 id=&#34;этап-1-теоретическое-обоснование-и-формулировка-задачи&#34;&gt;&lt;strong&gt;Этап 1. Теоретическое обоснование и формулировка задачи&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;На этом этапе мы:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Изучили основные принципы решеточных моделей газа (LGA) и решеточного уравнения Больцмана (LBE).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Ознакомились с базовыми моделями: HPP, FHP-I, FHP-III, а также с расширенной моделью с 9 направлениями скорости.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Проанализировали физические свойства этих моделей: симметрию, анизотропию, возможность сохранения импульса и энергии, введение температуры.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Изучили область применимости этих моделей — от моделирования жидкостей до фазовых переходов и химических взаимодействий.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Этот этап дал нам прочную теоретическую основу для дальнейших шагов, позволив критически осмыслить достоинства и ограничения моделей, и выбрать для реализации наиболее подходящую — модель HPP.&lt;/p&gt;
&lt;h3 id=&#34;этап-2-изучение-алгоритмов-и-структур-данных&#34;&gt;&lt;strong&gt;Этап 2. Изучение алгоритмов и структур данных&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;На втором этапе:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Мы подробно проанализировали алгоритмы распространения и столкновения частиц в решеточных моделях.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Были рассмотрены способы кодирования состояний узлов с помощью битовых операций, что обеспечило компактность и быстродействие реализации.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Сравнили особенности моделей HPP, FHP-I, FHP-III и LBM, включая их алгоритмическую сложность, вычислительные затраты, физическую реалистичность.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Сделали обоснованный выбор в пользу модели HPP, как стартовой точки: она проще в реализации, но при этом позволяет продемонстрировать ключевые принципы решеточного моделирования.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;этап-3-реализация-модели-и-проведение-численных-экспериментов&#34;&gt;&lt;strong&gt;Этап 3. Реализация модели и проведение численных экспериментов&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;На завершающем техническом этапе:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Мы реализовали модель HPP на языке Julia, выбрав его за высокую производительность, лаконичность и удобство для научных вычислений.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;В коде предусмотрены функции для:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;создания решетки и добавления частиц;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;применения периодических граничных условий;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;реализации правил столкновений (лобовых и угловых);&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;визуализации состояния системы;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;расчета макроскопических параметров (число частиц, импульс);&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;автоматического запуска тестов и создания анимаций.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Было реализовано три тестовых сценария, проверяющих:&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;корректность перемещения одной частицы;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;корректность лобового столкновения;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;поведение при угловом столкновении четырёх частиц.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Созданы анимации (GIF), наглядно демонстрирующие ход моделирования, а также сохранение физических величин во времени [@2].&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;коллективная-работа-над-проектом&#34;&gt;Коллективная работа над проектом&lt;/h2&gt;
&lt;h3 id=&#34;распределение-ролей-и-организация-взаимодействия&#34;&gt;Распределение ролей и организация взаимодействия&lt;/h3&gt;
&lt;p&gt;С самого начала работы над проектом мы договорились о чётком распределении ролей:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Теоретический анализ (описание модели, её математических основ, анализ преимуществ и недостатков) - все участники, с последующим обсуждением на общем собрании.&lt;/li&gt;
&lt;li&gt;Программная реализация - основная ответственность легла на участников с наиболее сильными навыками программирования на Julia (но все члены команды участвовали в обсуждении архитектуры кода).&lt;/li&gt;
&lt;li&gt;Тестирование и визуализация - совместная работа: каждый предлагал тестовые сценарии, участвовал в анализе результатов и подготовке анимаций.&lt;/li&gt;
&lt;li&gt;Оформление отчёта и презентаций - по частям, с последующим коллективным редактированием.
Регулярные встречи (очно и онлайн) позволяли быстро обмениваться идеями, выявлять ошибки и корректировать ход работы.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;коллективное-обсуждение-решений&#34;&gt;Коллективное обсуждение решений&lt;/h3&gt;
&lt;p&gt;Каждое важное решение принималось после обсуждения:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Как лучше реализовать периодические граничные условия?&lt;/li&gt;
&lt;li&gt;Как структурировать код для удобства тестирования?&lt;/li&gt;
&lt;li&gt;Какие тесты наиболее полно проверяют корректность модели?&lt;/li&gt;
&lt;li&gt;Как визуализировать результаты, чтобы они были максимально наглядными?
Обсуждение сопровождалось демонстрацией промежуточных результатов, разбором кода, анализом возникающих ошибок.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;программная-реализация&#34;&gt;Программная реализация&lt;/h2&gt;
&lt;h3 id=&#34;выбор-языка-и-инструментов&#34;&gt;Выбор языка и инструментов&lt;/h3&gt;
&lt;p&gt;Мы выбрали язык Julia за его высокую скорость, лаконичность и развитые средства для научных вычислений и визуализации. Для графиков использовалась библиотека Plots с бэкендом GR.&lt;/p&gt;
&lt;h3 id=&#34;архитектура-кода&#34;&gt;Архитектура кода&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Параметры модели (размеры решётки, направления движения частиц, цвета для визуализации) задаются в начале, что облегчает настройку и масштабирование модели.&lt;/li&gt;
&lt;li&gt;Создание сетки: реализована функция для создания булевой 3D-матрицы, где третье измерение отвечает за направления движения частиц.&lt;/li&gt;
&lt;li&gt;Добавление частиц: отдельная функция с проверкой корректности координат и направления.&lt;/li&gt;
&lt;li&gt;Периодические граничные условия: реализованы через фиктивные узлы по краям решётки и копирование значений с противоположных физических границ.&lt;/li&gt;
&lt;li&gt;Обработка столкновений: реализована по строгим правилам HPP, с учётом только физически осмысленных столкновений (лобовых и под прямым углом).&lt;/li&gt;
&lt;li&gt;Распространение частиц: реализовано через создание новой сетки и перенос частиц согласно их направлениям.&lt;/li&gt;
&lt;li&gt;Подсчёт числа частиц и импульса: отдельные функции для контроля сохранения физических величин.&lt;/li&gt;
&lt;li&gt;Визуализация: функция для отрисовки состояния решётки с цветными стрелками, показывающими направления движения частиц.&lt;/li&gt;
&lt;li&gt;Тесты: три ключевых сценария - одиночная частица, лобовое столкновение, столкновение под прямым углом. Для каждого теста создаётся анимация (GIF) [@3].&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;объяснение-выбора-архитектуры&#34;&gt;Объяснение выбора архитектуры&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Периодические граничные условия выбраны для проверки корректности распространения частиц: частица, вышедшая за одну границу, должна появляться с противоположной стороны, что важно для моделирования &amp;ldquo;бесконечных&amp;rdquo; сред.&lt;/li&gt;
&lt;li&gt;Разделение на функции повышает читаемость и удобство тестирования.&lt;/li&gt;
&lt;li&gt;Визуализация позволяет не только проверить корректность работы кода, но и наглядно продемонстрировать физический смысл происходящих процессов [@2].&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;анализ-результатов-что-получилось-и-почему&#34;&gt;Анализ результатов: что получилось и почему&lt;/h2&gt;
&lt;h3 id=&#34;корректность-работы-модели&#34;&gt;Корректность работы модели&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Тест 1 (одна частица): частица движется по прямой, корректно &amp;ldquo;переходит&amp;rdquo; через границы, возвращаясь с противоположной стороны. Число частиц и импульс сохраняются.&lt;/li&gt;
&lt;li&gt;Тест 2 (лобовое столкновение): две частицы встречаются, после столкновения меняют направления строго по правилам HPP. Сохраняются число частиц и импульс.&lt;/li&gt;
&lt;li&gt;Тест 3 (столкновение под прямым углом): четыре частицы встречаются в одной точке, после столкновения разлетаются в новые направления. Все законы сохранения выполняются [@1].&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;визуализация&#34;&gt;Визуализация&lt;/h3&gt;
&lt;p&gt;Для каждого теста были созданы анимации, позволяющие шаг за шагом наблюдать за эволюцией системы. Это позволило:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Убедиться в правильности работы алгоритма.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Наглядно продемонстрировать физические процессы (распространение, столкновения, сохранение числа частиц и импульса).&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;достижения-и-ограничения&#34;&gt;Достижения и ограничения&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Достижения: реализована полностью работоспособная модель HPP, все физические законы выполняются, тесты проходят успешно, визуализация информативна.&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;Ограничения: модель HPP обладает известными недостатками (анизотропия, нефизичное поведение на макроуровне), о чём мы честно говорим в отчёте. Для более точного моделирования реальных жидкостей и газов требуются более сложные модели (например, FHP).&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;качество-работы-кода-подробный-разбор&#34;&gt;Качество работы кода: подробный разбор&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Структурированность, читаемость и модульность&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Код организован в виде отдельных функций, каждая из которых отвечает за свою задачу:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;создание сетки (&lt;code&gt;create_grid&lt;/code&gt;),&lt;/li&gt;
&lt;li&gt;добавление частицы (&lt;code&gt;add_particle!&lt;/code&gt;),&lt;/li&gt;
&lt;li&gt;применение граничных условий (&lt;code&gt;apply_periodic_boundaries!&lt;/code&gt;),&lt;/li&gt;
&lt;li&gt;обработка столкновений (&lt;code&gt;collide!&lt;/code&gt;),&lt;/li&gt;
&lt;li&gt;распространение частиц (&lt;code&gt;propagate!&lt;/code&gt;),&lt;/li&gt;
&lt;li&gt;подсчёт числа частиц (&lt;code&gt;count_particles&lt;/code&gt;),&lt;/li&gt;
&lt;li&gt;вычисление импульса (&lt;code&gt;calculate_momentum&lt;/code&gt;),&lt;/li&gt;
&lt;li&gt;визуализация (&lt;code&gt;plot_grid&lt;/code&gt;),&lt;/li&gt;
&lt;li&gt;запуск тестов (&lt;code&gt;run_all_tests&lt;/code&gt;).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Преимущества такого подхода:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Код легко читать и поддерживать.&lt;/li&gt;
&lt;li&gt;Каждая функция имеет чётко определённую ответственность.&lt;/li&gt;
&lt;li&gt;Можно быстро находить и исправлять ошибки, а также расширять функционал.&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;Корректность реализации физических принципов&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;2.1. Периодические граничные условия&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Реализованы через фиктивные узлы по краям сетки и копирование значений с противоположных физических границ.&lt;/li&gt;
&lt;li&gt;Проверка на одной частице (Тест 1) показывает: частица, выходя за одну границу, корректно появляется с противоположной стороны.&lt;/li&gt;
&lt;li&gt;Это подтверждает правильную реализацию периодичности, что критически важно для моделирования &amp;ldquo;бесконечной&amp;rdquo; среды.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;2.2. Столкновения частиц&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;В функции &lt;code&gt;collide!&lt;/code&gt; реализованы два типа столкновений: лобовое (две частицы навстречу) и под прямым углом (четыре частицы).&lt;/li&gt;
&lt;li&gt;Логика соответствует теории HPP: направления меняются строго по правилам, обеспечивается сохранение числа частиц и импульса.&lt;/li&gt;
&lt;li&gt;Тесты 2 и 3 (лобовое и угловое столкновения) показывают: после столкновения частицы разлетаются в правильных направлениях.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;2.3. Сохранение числа частиц и импульса&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;На каждом шаге моделирования в тестах вычисляются и выводятся общее число частиц и суммарный импульс.&lt;/li&gt;
&lt;li&gt;В анимациях и текстовых аннотациях видно, что эти величины сохраняются, что говорит о физической корректности кода.&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Гибкость и расширяемость&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Размер сетки, направления движения, цвета для визуализации задаются в начале через константы, что позволяет легко менять параметры модели.&lt;/li&gt;
&lt;li&gt;Код легко масштабируется: можно увеличивать размеры сетки, добавлять новые сценарии тестирования, менять правила столкновений.&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;Визуализация и наглядность&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Для каждого теста создаются анимации (GIF), где визуально отображается движение и столкновения частиц, а также аннотируются число частиц и импульс.&lt;/li&gt;
&lt;li&gt;Использование разных цветов для направлений делает анимации понятными даже без глубокого погружения в код.&lt;/li&gt;
&lt;li&gt;Визуализация помогает не только анализировать корректность, но и презентовать результаты на защите.&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;Тестируемость и автоматизация проверки&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;В коде реализованы отдельные функции для трёх ключевых тестов:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;одна частица (проверка распространения и граничных условий),&lt;/li&gt;
&lt;li&gt;две частицы (лобовое столкновение),&lt;/li&gt;
&lt;li&gt;четыре частицы (столкновение под прямым углом).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Функция &lt;code&gt;run_all_tests&lt;/code&gt; позволяет запускать все тесты последовательно, что удобно для автоматической проверки и демонстрации.&lt;/p&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;Обработка ошибок и валидация данных&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;Используются &lt;code&gt;@assert&lt;/code&gt; для проверки корректности координат частиц и направлений при добавлении в сетку.&lt;/li&gt;
&lt;li&gt;Это предотвращает появление некорректных состояний и облегчает отладку.&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;7&#34;&gt;
&lt;li&gt;Документированность&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;В отчёте приведены подробные комментарии к каждой функции, объясняющие смысл и работу каждого блока кода.&lt;/li&gt;
&lt;li&gt;Описаны все используемые параметры и логика работы алгоритма.&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;8&#34;&gt;
&lt;li&gt;Ограничения и честная самооценка&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;В отчёте честно указаны ограничения самой модели HPP (анизотропия, нефизичность на макроуровне), а не только кода.&lt;/li&gt;
&lt;li&gt;Это говорит о критическом отношении к результату и понимании границ применимости [@3].&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;коллективное-обсуждение-итогов-и-самооценка-деятельности&#34;&gt;Коллективное обсуждение итогов и самооценка деятельности&lt;/h2&gt;
&lt;h3 id=&#34;обсуждение-трудностей-и-путей-их-решения&#34;&gt;Обсуждение трудностей и путей их решения&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Сложности с граничными условиями: на этапе реализации периодических границ возникли ошибки, которые были обнаружены при коллективном просмотре анимаций и исправлены после обсуждения.&lt;/li&gt;
&lt;li&gt;Проверка корректности столкновений: не сразу удалось реализовать все случаи столкновений, потребовалось несколько итераций и обсуждений.&lt;/li&gt;
&lt;li&gt;Временные ограничения: благодаря командной работе и чёткому плану удалось уложиться в сроки.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;индивидуальный-и-командный-вклад&#34;&gt;Индивидуальный и командный вклад&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Каждый участник внёс вклад в теорию, программирование, тестирование и оформление отчёта.&lt;/li&gt;
&lt;li&gt;Совместная работа позволила каждому освоить новые навыки: кто-то углубился в программирование на &lt;code&gt;Julia&lt;/code&gt;, кто-то - в физику решеточных моделей, кто-то - в визуализацию данных.&lt;/li&gt;
&lt;li&gt;В процессе обсуждений и совместного поиска решений повысился уровень взаимопонимания и доверия в команде.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;самооценка&#34;&gt;Самооценка&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Цели этапа полностью достигнуты: реализована модель, проведено тестирование, оформлен подробный отчёт.&lt;/li&gt;
&lt;li&gt;Качество реализации: код структурирован, документирован, легко расширяется для новых задач.&lt;/li&gt;
&lt;li&gt;Командная работа: эффективное распределение задач, взаимопомощь, своевременное решение проблем.&lt;/li&gt;
&lt;li&gt;Личные достижения: каждый участник повысил свою квалификацию в области научного моделирования и командной работы.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;выводы-и-рекомендации&#34;&gt;Выводы и рекомендации&lt;/h2&gt;
&lt;p&gt;Работа над проектом позволила нам:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Освоить современные методы моделирования физических процессов.&lt;/li&gt;
&lt;li&gt;Получить опыт командной работы, научиться планировать и реализовывать сложные проекты.&lt;/li&gt;
&lt;li&gt;Научиться анализировать и визуализировать результаты моделирования.&lt;/li&gt;
&lt;li&gt;Критически оценивать свои достижения и ограничения [@4].&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Наш проект продемонстрировал, что даже относительно простые решеточные модели позволяют точно и эффективно описывать поведение газов на микроскопическом уровне. Мы прошли путь от теории к практике, реализовав рабочую систему и подтвердив её корректность с помощью численных экспериментов.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Возможное продолжение работы:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Модернизация модели: переход от HPP к FHP-III, чтобы устранить анизотропию и повысить физическую достоверность.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Добавление термодинамики: переход к модели с 9 направлениями и введение температуры.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Моделирование фазовых переходов: добавление сил взаимодействия между частицами.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Переход к LBE: для описания вязких течений и сложных граничных условий.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Параллелизация: реализация на GPU с помощью CUDA.jl для повышения производительности [@4].&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;заключительная-часть&#34;&gt;Заключительная часть&lt;/h1&gt;
&lt;h2 id=&#34;заключение&#34;&gt;Заключение&lt;/h2&gt;
&lt;p&gt;Проект был реализован на высоком уровне благодаря слаженной работе команды, глубокому анализу теории и тщательному тестированию программной реализации. Каждый участник внёс значимый вклад, а коллективное обсуждение позволило не только добиться отличного результата, но и получить ценный опыт научного сотрудничества.&lt;/p&gt;
&lt;h1 id=&#34;список-литературы&#34;&gt;Список литературы&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Медведев Д.А. и др. Моделирование физических процессов и явлений на ПК: Учеб. пособие. // Новосибирск: Новосиб. гос. ун-т, 2010. 101 с.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Куперштох А. Л. Моделирование течений с границами раздела жидкость-пар методом решеточных уравнениях Больцмана //
Вестник НГУ. Сер. Математика, механика и информатика. 2005. Т. 5, № 3. с. 29–42.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Chen S., Lee M., Zhao K. H., Doolen G. D. A lattice gas model with temperature // Physica D. 1989. V. 37. p. 42–59.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://doi.org/10.20948/prepr-2021-99&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Чащин Г.С. Метод решёточных уравнений Больцмана: моделирование изотермических низкоскоростных течений&lt;/a&gt; // &lt;a href=&#34;https://library.keldysh.ru/preprint.asp?id=2021-99&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Препринты ИПМ им. М.В.Келдыша. 2021. № 99. 31 с.&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Frisch, Uriel, Brosl Hasslacher, and Yves Pomeau. &amp;ldquo;Lattice Gas Automata for the Navier-Stokes Equation.&amp;rdquo; Phys. Rev. Lett. 56, no. 14 (1986): 1505-1508.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Succi, Sauro. The Lattice Boltzmann Equation for Fluid Dynamics and Beyond. Oxford University Press, 2001.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    
    <item>
      <title>Третий этап проекта</title>
      <link>http://localhost:1313/publication/3step/</link>
      <pubDate>Thu, 01 May 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/publication/3step/</guid>
      <description>&lt;h1 id=&#34;введение&#34;&gt;Введение&lt;/h1&gt;
&lt;h2 id=&#34;цель-проекта&#34;&gt;Цель проекта&lt;/h2&gt;
&lt;p&gt;Разработать и проанализировать модель на основе решеточного уравнения Больцмана для описания течений газа.&lt;/p&gt;
&lt;h2 id=&#34;задачи-третьего-этапа-проекта&#34;&gt;Задачи третьего этапа проекта&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Реализовать и описать программный алгоритм решения задачи.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;актуальность&#34;&gt;Актуальность&lt;/h2&gt;
&lt;p&gt;Моделирование газовых потоков и жидкостей традиционными методами требует значительных вычислительных ресурсов. В связи с этим, методы решеточных газов (LGA) и решеточного уравнения Больцмана (LBE) становятся все более актуальными. Они позволяют упростить вычисления, сохраняя при этом физическую достоверность, и находят применение в различных областях, от гидродинамики до биофизики. В данном докладе мы рассмотрим основные алгоритмы и модели, используемые для решения задач с применением LGA и LBE.&lt;/p&gt;
&lt;h1 id=&#34;основная-часть&#34;&gt;Основная часть&lt;/h1&gt;
&lt;h2 id=&#34;модель-hpp-hardypomeaupazzis&#34;&gt;Модель HPP (Hardy–Pomeau–Pazzis)&lt;/h2&gt;
&lt;p&gt;Модель HPP (Hardy-Pomeau-Pazzis) — это базовая модель решеточных газов (LGA), используемая для моделирования гидродинамических явлений на микроскопическом уровне. Она представляет собой дискретную систему, где пространство и время дискретизованы, а частицы двигаются по узлам квадратной решетки.&lt;/p&gt;
&lt;h3 id=&#34;основные-характеристики-модели-hpp&#34;&gt;Основные характеристики модели HPP:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Решетка&lt;/strong&gt;: используется двумерная квадратная решетка, где узлы расположены на одинаковом расстоянии друг от друга.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Частицы&lt;/strong&gt;: в каждом узле решетки могут находиться частицы единичной массы. Каждая частица может двигаться в одном из четырех направлений: вверх, вниз, вправо или влево.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Скорость&lt;/strong&gt;: все частицы имеют одинаковую скорость, направленную к соседнему узлу. Расстояние между узлами ($\Delta x$) и шаг времени ($\Delta t$) выбираются так, чтобы частица могла переместиться в соседний узел за один временной шаг.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Принцип исключения&lt;/strong&gt;: в каждом узле может находиться не более одной частицы, движущейся в заданном направлении.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Этапы эволюции&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Распространение (Streaming)&lt;/strong&gt;: частицы перемещаются в соседние узлы в соответствии со своими скоростями. За один шаг времени частица переходит в соседний узел в направлении своего движения.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Столкновения (Collision)&lt;/strong&gt;: в узлах происходят столкновения частиц, при которых сохраняются количество частиц и полный импульс.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Правила столкновений&lt;/strong&gt;: столкновения происходят таким образом, чтобы выполнялись законы сохранения. В модели HPP нетривиальные столкновения происходят, когда две частицы движутся навстречу друг другу (почти &amp;ldquo;лоб в лоб&amp;rdquo;). После столкновения частицы меняют направления движения на 90 градусов. Во всех остальных случаях столкновения считаются несущественными, и частицы продолжают двигаться в прежних направлениях.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Кодирование состояний&lt;/strong&gt;: состояние каждого узла решетки кодируется битами. Поскольку имеется четыре возможных направления движения, для кодирования состояния узла требуется четыре бита. Каждый бит соответствует одному из направлений: 0 — нет частицы, 1 — есть частица, движущаяся в этом направлении. Например, если частицы движутся вправо и вверх, состояние узла кодируется как &lt;code&gt;0101&lt;/code&gt; в двоичном формате [@medvedev2010, @chaschin2021]&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Примеры перемещений частиц в модели HPP&#34; srcset=&#34;
               /media/3step/HppModelExamples_huef7440bf026680eb577c23db4d515b1c_10139_3f9b38726750b8d7932ecf5c868b04e4.webp 400w,
               /media/3step/HppModelExamples_huef7440bf026680eb577c23db4d515b1c_10139_ef65cad411fb84aa1bb4f206a36206b6.webp 760w,
               /media/3step/HppModelExamples_huef7440bf026680eb577c23db4d515b1c_10139_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;http://localhost:1313/media/3step/HppModelExamples_huef7440bf026680eb577c23db4d515b1c_10139_3f9b38726750b8d7932ecf5c868b04e4.webp&#34;
               width=&#34;440&#34;
               height=&#34;208&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h3 id=&#34;математическое-описание&#34;&gt;Математическое описание:&lt;/h3&gt;
&lt;p&gt;Обозначим возможные направления скорости как $d_1, d_2, d_3, d_4$$. Тогда:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;$d_1 = 0001_2 = 1$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$d_2 = 0010_2 = 2$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$d_3 = 0100_2 = 4$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$d_4 = 1000_2 = 8$&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Основные операции для работы с состояниями узлов:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Добавление частицы&lt;/strong&gt;: добавление к состоянию $S$ частицы с направлением скорости $d_k$:
$$
S \text{ OR } d_k \rightarrow S
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Проверка наличия частицы&lt;/strong&gt;: проверка, есть ли в состоянии $S$ частица с направлением скорости $d_k$:
$$
\text{if } (S \text{ AND } d_k) \neq 0
$$
Если результат не равен 0, то частица с направлением $d_k$ присутствует в узле.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;недостатки-модели-hpp&#34;&gt;Недостатки модели HPP:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Отсутствие симметрии&lt;/strong&gt;: квадратная решетка с четырьмя направлениями скорости недостаточно симметрична, что приводит к анизотропии в макроскопических свойствах.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Нефизичное поведение&lt;/strong&gt;: модель HPP неточно описывает гидродинамические свойства жидкостей и газов.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Для устранения этих недостатков были разработаны более совершенные модели, такие как FHP (Frisch-Hasslacher-Pomeau) на треугольных решетках и модели с добавлением покоящихся частиц.&lt;/p&gt;
&lt;h2 id=&#34;описание-задания&#34;&gt;Описание задания&lt;/h2&gt;
&lt;p&gt;Реализуйте модель HPP. Задайте периодические граничные условия. Это просто сделать, добавив по одному ряду узлов с каждой стороны области (фиктивные узлы). Перед шагом распространения необходимо скопировать значения левого ряда физических узлов в правый фиктивный ряд. Тогда частицы, вылетая из левой границы области налево, появятся на ее правой границе. С другими границами поступают также. Вначале возьмите одну единственную частицу  и проверьте правильность всех граничных условий. Затем убедитесь, что для двух частиц их столкновения &amp;ldquo;почти лоб в лоб&amp;rdquo; и под прямым углом происходят верно. Для любого числа частиц должны сохраняться их полное число и полный импульс.&lt;/p&gt;
&lt;h2 id=&#34;описание-программного-кода&#34;&gt;Описание программного кода&lt;/h2&gt;
&lt;p&gt;Код для модели HPP мы реализовали на языке Julia.&lt;/p&gt;
&lt;h3 id=&#34;подключение-библиотек-и-настройка-визуализации&#34;&gt;Подключение библиотек и настройка визуализации&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-julia&#34; data-lang=&#34;julia&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;using&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Plots&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;gr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Подключается пакет &lt;code&gt;Plots&lt;/code&gt; для построения графиков.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Выбирается бэкенд &lt;code&gt;gr()&lt;/code&gt; для отрисовки.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;константы-и-параметры-модели&#34;&gt;Константы и параметры модели&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-julia&#34; data-lang=&#34;julia&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Nx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dy&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dir_colors&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;ss&#34;&gt;:red&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;:blue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;:green&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;:purple&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;Nx&lt;/code&gt;, &lt;code&gt;Ny&lt;/code&gt; - размеры внутренней области решетки (без фиктивных узлов).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;dx&lt;/code&gt;, &lt;code&gt;dy&lt;/code&gt; - массивы смещений по x и y для четырёх направлений движения частиц: вправо, вверх, влево, вниз.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;dir_colors&lt;/code&gt; - цвета для визуализации направлений частиц.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;создание-пустой-сетки&#34;&gt;Создание пустой сетки&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-julia&#34; data-lang=&#34;julia&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;create_grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;zeros&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;Bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Nx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Создаётся булев массив размером &lt;code&gt;(Nx+2, Ny+2, 4)&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;Nx+2&lt;/code&gt; и &lt;code&gt;Ny+2&lt;/code&gt; - учитывают фиктивные узлы по краям (по одному ряду с каждой стороны).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Последнее измерение &lt;code&gt;4&lt;/code&gt; - количество направлений движения частиц.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Все значения изначально &lt;code&gt;false&lt;/code&gt; (нет частиц).&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;добавление-частицы-в-сетку&#34;&gt;Добавление частицы в сетку&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-julia&#34; data-lang=&#34;julia&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;add_particle!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nd&#34;&gt;@assert&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;≤&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;≤&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Nx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;≤&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;≤&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;Particle must be inside physical domain&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nd&#34;&gt;@assert&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;≤&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;≤&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;Direction must be between 1 and 4&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Добавляет частицу в позицию &lt;code&gt;(x, y)&lt;/code&gt; с направлением &lt;code&gt;d&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;x+1&lt;/code&gt;, &lt;code&gt;y+1&lt;/code&gt; - сдвиг на 1 из-за фиктивных узлов.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Проверяется корректность координат и направления.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;применение-периодических-граничных-условий&#34;&gt;Применение периодических граничных условий&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-julia&#34; data-lang=&#34;julia&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;apply_periodic_boundaries!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c&#34;&gt;# левая фиктивная = правая физическая&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;.=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Nx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;     
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c&#34;&gt;# правая фиктивная = левая физическая&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Nx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;.=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;     
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c&#34;&gt;# нижняя фиктивная = верхняя физическая&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Nx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;.=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Nx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;     
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c&#34;&gt;# верхняя фиктивная = нижняя физическая&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Nx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;.=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Nx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;     
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Для каждого направления &lt;code&gt;d&lt;/code&gt; копирует значения с противоположных физических границ в фиктивные узлы.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Обеспечивает периодичность: частицы, выходящие с одной границы, появляются с противоположной.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;обработка-столкновений-частиц&#34;&gt;Обработка столкновений частиц&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-julia&#34; data-lang=&#34;julia&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;collide!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Nx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;up&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;down&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;right&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;left&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;up&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;down&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;elseif&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;up&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;down&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;right&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Проходит по всем физическим узлам.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Проверяет столкновения:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Лобовое: если есть частицы вправо и влево, меняет их направления на вверх и вниз.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Под прямым углом: если есть частицы вверх и вниз, меняет направления на вправо и влево.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Другие случаи столкновений не обрабатываются (частицы проходят без изменений).&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;распространение-частиц&#34;&gt;Распространение частиц&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-julia&#34; data-lang=&#34;julia&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;propagate!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;new_grid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;zeros&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;Bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Nx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;nx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ny&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;new_grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ny&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;new_grid&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Создаёт новую пустую сетку.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Для каждой частицы вычисляет новую позицию, смещая по направлению &lt;code&gt;d&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Записывает частицу в новую позицию.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Возвращает обновлённую сетку.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;подсчёт-числа-частиц&#34;&gt;Подсчёт числа частиц&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-julia&#34; data-lang=&#34;julia&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;count_particles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;sum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Nx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Считает общее количество частиц во всех направлениях во всех физических узлах.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;вычисление-суммарного-импульса&#34;&gt;Вычисление суммарного импульса&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-julia&#34; data-lang=&#34;julia&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;calculate_momentum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;px&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;py&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Nx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c&#34;&gt;# движение вправо минус влево&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;px&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;c&#34;&gt;# движение вверх минус вниз&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;py&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;px&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;py&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Суммирует по всем узлам разницу частиц, движущихся в противоположных направлениях, по осям X и Y.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Возвращает вектор импульса.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;визуализация-состояния-решетки&#34;&gt;Визуализация состояния решетки&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-julia&#34; data-lang=&#34;julia&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plot_grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;step&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;heatmap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Nx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;zeros&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Nx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;ss&#34;&gt;:white&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;aspect_ratio&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;legend&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;xlims&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Nx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ylims&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;title&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;HPP Model (Step &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;$step&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;)&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;plot!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Nx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Nx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;             &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;n&#34;&gt;color&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;ss&#34;&gt;:black&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;linewidth&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;label&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Nx&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;n&#34;&gt;quiver!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;quiver&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                                         &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                   &lt;span class=&#34;n&#34;&gt;color&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dir_colors&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;lw&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;arrow&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Создаёт белый холст с размерами решетки.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Рисует чёрную рамку вокруг области.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Для каждой частицы рисует стрелку в направлении движения с цветом, соответствующим направлению.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Возвращает объект графика.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;запуск-всех-тестов&#34;&gt;Запуск всех тестов&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-julia&#34; data-lang=&#34;julia&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;run_all_tests&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Running single particle test...&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;test_single_particle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Running head-on collision test...&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;test_head_on_collision&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Running right angle collision test...&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;test_right_angle_collision&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;All tests completed! Check generated GIFs.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;run_all_tests&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;test_single_particle()&lt;/strong&gt; - одна частица в центре движется вправо, проверяется распространение и периодичность.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-Julia&#34; data-lang=&#34;Julia&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c&#34;&gt;# Тест 1: Одна частица&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;test_single_particle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;create_grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c&#34;&gt;# Частица в центре, движется вправо&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;add_particle!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Nx÷2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Ny÷2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;anim&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nd&#34;&gt;@animate&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;step&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;20&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;apply_periodic_boundaries!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;collide!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plot_grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;step&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;propagate!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;count_particles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;px&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;py&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;calculate_momentum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;annotate!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1.2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Particles: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;$n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;:left&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;annotate!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Momentum: (&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;$px&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;, &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;$py&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;)&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;:left&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;gif&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;anim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;hpp_single_particle.gif&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fps&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Запуск теста №1. Одна частица в центре, движется вправо. Шаг №1&#34; srcset=&#34;
               /media/3step/8_hu5e2b01a6264d91c13b3a1c790063b0ff_14594_6680d5f965909a9627a546cadb09dcb1.webp 400w,
               /media/3step/8_hu5e2b01a6264d91c13b3a1c790063b0ff_14594_940f50dcb07e9249b0c24c6f9e5c5500.webp 760w,
               /media/3step/8_hu5e2b01a6264d91c13b3a1c790063b0ff_14594_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;http://localhost:1313/media/3step/8_hu5e2b01a6264d91c13b3a1c790063b0ff_14594_6680d5f965909a9627a546cadb09dcb1.webp&#34;
               width=&#34;600&#34;
               height=&#34;400&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Запуск теста №1. Одна частица в центре, движется вправо. Шаг №2&#34; srcset=&#34;
               /media/3step/9_huf5edb93e062ec0e62b05275c7e41b0ff_14702_3a9bad367b766fc05d0dfe7dcf1c248c.webp 400w,
               /media/3step/9_huf5edb93e062ec0e62b05275c7e41b0ff_14702_2ab13e2488cf012b0337c7254be63160.webp 760w,
               /media/3step/9_huf5edb93e062ec0e62b05275c7e41b0ff_14702_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;http://localhost:1313/media/3step/9_huf5edb93e062ec0e62b05275c7e41b0ff_14702_3a9bad367b766fc05d0dfe7dcf1c248c.webp&#34;
               width=&#34;600&#34;
               height=&#34;400&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Запуск теста №1. Одна частица в центре, движется вправо. Шаг №4&#34; srcset=&#34;
               /media/3step/10_hua56aabfc7cbc96378113f88131faebf3_14706_444e523d71445410b10796eb76586495.webp 400w,
               /media/3step/10_hua56aabfc7cbc96378113f88131faebf3_14706_969d85b9fbd2a8b88c7c3f6bc6cfed86.webp 760w,
               /media/3step/10_hua56aabfc7cbc96378113f88131faebf3_14706_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;http://localhost:1313/media/3step/10_hua56aabfc7cbc96378113f88131faebf3_14706_444e523d71445410b10796eb76586495.webp&#34;
               width=&#34;600&#34;
               height=&#34;400&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;test_head_on_collision()&lt;/strong&gt; - две частицы движутся навстречу, проверяется лобовое столкновение.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-Julia&#34; data-lang=&#34;Julia&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c&#34;&gt;# Тест 2: Две частицы (лобовое столкновение)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;test_head_on_collision&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;create_grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;add_particle!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;c&#34;&gt;# →&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;add_particle!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;c&#34;&gt;# ←&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;anim&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nd&#34;&gt;@animate&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;step&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;apply_periodic_boundaries!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;collide!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plot_grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;step&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;propagate!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;count_particles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;px&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;py&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;calculate_momentum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;annotate!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1.2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Particles: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;$n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;:left&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;annotate!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Momentum: (&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;$px&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;, &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;$py&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;)&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;:left&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;gif&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;anim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;hpp_head_on.gif&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fps&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Запуск теста №2. Две частицы движутся навстречу, лобовое столкновение. Шаг №1&#34; srcset=&#34;
               /media/3step/5_hu70a3609a5b227af361bf1ff50e238741_14161_bcea835e48c564eb9e4806ed98545ca6.webp 400w,
               /media/3step/5_hu70a3609a5b227af361bf1ff50e238741_14161_8154257479f3bd183ceef1265496e08b.webp 760w,
               /media/3step/5_hu70a3609a5b227af361bf1ff50e238741_14161_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;http://localhost:1313/media/3step/5_hu70a3609a5b227af361bf1ff50e238741_14161_bcea835e48c564eb9e4806ed98545ca6.webp&#34;
               width=&#34;600&#34;
               height=&#34;400&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Запуск теста №2. Две частицы движутся навстречу, лобовое столкновение. Шаг №2&#34; srcset=&#34;
               /media/3step/6_hu8fd7ba58cc4e4604ce92326ad79bd603_14290_a458451903a1ba03300a4fa3278c9169.webp 400w,
               /media/3step/6_hu8fd7ba58cc4e4604ce92326ad79bd603_14290_8c4948a8490f5a33e3ec24dadec74fff.webp 760w,
               /media/3step/6_hu8fd7ba58cc4e4604ce92326ad79bd603_14290_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;http://localhost:1313/media/3step/6_hu8fd7ba58cc4e4604ce92326ad79bd603_14290_a458451903a1ba03300a4fa3278c9169.webp&#34;
               width=&#34;600&#34;
               height=&#34;400&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Запуск теста №2. Две частицы движутся навстречу, лобовое столкновение. Шаг №3&#34; srcset=&#34;
               /media/3step/7_hucc27cd5cb9f57f61f51cecc3dd7ea3b4_14304_0ca00bcff72d981078f518fd0df30311.webp 400w,
               /media/3step/7_hucc27cd5cb9f57f61f51cecc3dd7ea3b4_14304_9c565997da6b94d7d0de48923f79d139.webp 760w,
               /media/3step/7_hucc27cd5cb9f57f61f51cecc3dd7ea3b4_14304_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;http://localhost:1313/media/3step/7_hucc27cd5cb9f57f61f51cecc3dd7ea3b4_14304_0ca00bcff72d981078f518fd0df30311.webp&#34;
               width=&#34;600&#34;
               height=&#34;400&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;test_right_angle_collision()&lt;/strong&gt; - четыре частицы движутся навстречу под прямым углом, проверяется корректность столкновений.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-Julia&#34; data-lang=&#34;Julia&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c&#34;&gt;# Тест 3: Четыре частицы (столкновение под прямым углом)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;test_right_angle_collision&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;create_grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;add_particle!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;c&#34;&gt;# ↑&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;add_particle!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;c&#34;&gt;# ↓&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;add_particle!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;c&#34;&gt;# →&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;add_particle!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;  &lt;span class=&#34;c&#34;&gt;# ←&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;anim&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nd&#34;&gt;@animate&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;step&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;apply_periodic_boundaries!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;collide!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;plot_grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;step&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;propagate!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;count_particles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;px&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;py&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;calculate_momentum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;grid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;annotate!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1.2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Particles: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;$n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;:left&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;annotate!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;0.5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;0.8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Momentum: (&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;$px&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;, &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;$py&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;)&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;ss&#34;&gt;:left&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;n&#34;&gt;p&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;gif&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;anim&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;hpp_right_angle.gif&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fps&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;end&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Запуск теста №3. Четыре частицы движутся навстречу под прямым углом. Шаг №1&#34; srcset=&#34;
               /media/3step/1_hue936d61c1ef5f49174ec01f128b35231_15196_959c85425b2508fbfef45b2aaea3d82b.webp 400w,
               /media/3step/1_hue936d61c1ef5f49174ec01f128b35231_15196_3f523a69d7e7b039383f5bd2dea572ed.webp 760w,
               /media/3step/1_hue936d61c1ef5f49174ec01f128b35231_15196_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;http://localhost:1313/media/3step/1_hue936d61c1ef5f49174ec01f128b35231_15196_959c85425b2508fbfef45b2aaea3d82b.webp&#34;
               width=&#34;600&#34;
               height=&#34;400&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Запуск теста №3. Четыре частицы движутся навстречу под прямым углом. Шаг №2&#34; srcset=&#34;
               /media/3step/2_hu6766c73dd2fc37655bc784b221812af9_15155_5c85ecda18ee9f93abe752deb44e83c0.webp 400w,
               /media/3step/2_hu6766c73dd2fc37655bc784b221812af9_15155_f754bea626a1868e8e114f0571947d0d.webp 760w,
               /media/3step/2_hu6766c73dd2fc37655bc784b221812af9_15155_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;http://localhost:1313/media/3step/2_hu6766c73dd2fc37655bc784b221812af9_15155_5c85ecda18ee9f93abe752deb44e83c0.webp&#34;
               width=&#34;600&#34;
               height=&#34;400&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Запуск теста №3. Четыре частицы движутся навстречу под прямым углом. Шаг №3&#34; srcset=&#34;
               /media/3step/3_hu29cf631fd58130c656a20e20beab0a91_15434_1b6eb6d6e017603cca9a034e08830be0.webp 400w,
               /media/3step/3_hu29cf631fd58130c656a20e20beab0a91_15434_8eceaf15e2a7f6574fd1ca572194c5b4.webp 760w,
               /media/3step/3_hu29cf631fd58130c656a20e20beab0a91_15434_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;http://localhost:1313/media/3step/3_hu29cf631fd58130c656a20e20beab0a91_15434_1b6eb6d6e017603cca9a034e08830be0.webp&#34;
               width=&#34;600&#34;
               height=&#34;400&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;В каждом тесте:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Создаётся сетка.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Добавляются частицы.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;В цикле на каждом шаге применяются граничные условия, столкновения, визуализация и распространение.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Считается число частиц и импульс.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Создаётся анимация и сохраняется в GIF.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;заключительная-часть&#34;&gt;Заключительная часть&lt;/h1&gt;
&lt;h2 id=&#34;заключение&#34;&gt;Заключение&lt;/h2&gt;
&lt;p&gt;Модели решеточных газов  $(LGA)$ и решеточное уравнение Больцмана $(LBE)$ представляют собой эффективные инструменты для моделирования газовых потоков. В данной части проекта мы рассмотрели простую базовую модель $HPP$.&lt;/p&gt;
&lt;p&gt;Реализовали двумерную модель решеточного газа HPP с четырьмя направлениями движения, периодическими граничными условиями, обработкой столкновений и визуализацией. Тесты демонстрируют корректность работы модели и сохранение физических величин (число частиц и импульс).&lt;/p&gt;
&lt;h2 id=&#34;выводы&#34;&gt;Выводы&lt;/h2&gt;
&lt;p&gt;Во время выполнения третьего этапа группового проекта мы описали и реализовали модель HPP - базовую модель решеточных газов (LGA), которая может быть использована для моделирования решеточного уравнения Больцмана.&lt;/p&gt;
&lt;h1 id=&#34;список-литературы&#34;&gt;Список литературы&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Медведев Д.А. и др. Моделирование физических процессов и явлений на ПК: Учеб. пособие. // Новосибирск: Новосиб. гос. ун-т, 2010. 101 с.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Куперштох А. Л. Моделирование течений с границами раздела жидкость-пар методом решеточных уравнениях Больцмана //
Вестник НГУ. Сер. Математика, механика и информатика. 2005. Т. 5, № 3. с. 29–42.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Chen S., Lee M., Zhao K. H., Doolen G. D. A lattice gas model with temperature // Physica D. 1989. V. 37. p. 42–59.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://doi.org/10.20948/prepr-2021-99&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Чащин Г.С. Метод решёточных уравнений Больцмана: моделирование изотермических низкоскоростных течений&lt;/a&gt; // &lt;a href=&#34;https://library.keldysh.ru/preprint.asp?id=2021-99&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Препринты ИПМ им. М.В.Келдыша. 2021. № 99. 31 с.&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Frisch, Uriel, Brosl Hasslacher, and Yves Pomeau. &amp;ldquo;Lattice Gas Automata for the Navier-Stokes Equation.&amp;rdquo; Phys. Rev. Lett. 56, no. 14 (1986): 1505-1508.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Succi, Sauro. The Lattice Boltzmann Equation for Fluid Dynamics and Beyond. Oxford University Press, 2001.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    
    <item>
      <title>Второй этап проекта</title>
      <link>http://localhost:1313/publication/2step/</link>
      <pubDate>Wed, 09 Apr 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/publication/2step/</guid>
      <description>&lt;h1 id=&#34;введение&#34;&gt;Введение&lt;/h1&gt;
&lt;h2 id=&#34;цель-проекта&#34;&gt;Цель проекта&lt;/h2&gt;
&lt;p&gt;Разработать и проанализировать модель на основе решеточного уравнения Больцмана для описания течений газа.&lt;/p&gt;
&lt;h2 id=&#34;задачи-второго-этапа-проекта&#34;&gt;Задачи второго этапа проекта&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Исследовать алгоритмы решения задачи&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;актуальность&#34;&gt;Актуальность&lt;/h2&gt;
&lt;p&gt;Моделирование газовых потоков и жидкостей традиционными методами требует значительных вычислительных ресурсов. В связи с этим, методы решеточных газов (LGA) и решеточного уравнения Больцмана (LBE) становятся все более актуальными. Они позволяют упростить вычисления, сохраняя при этом физическую достоверность, и находят применение в различных областях, от гидродинамики до биофизики. В данном докладе мы рассмотрим основные алгоритмы и модели, используемые для решения задач с применением LGA и LBE.&lt;/p&gt;
&lt;h1 id=&#34;основная-часть&#34;&gt;Основная часть&lt;/h1&gt;
&lt;h2 id=&#34;модель-hpp-hardypomeaupazzis&#34;&gt;Модель HPP (Hardy–Pomeau–Pazzis)&lt;/h2&gt;
&lt;p&gt;Модель HPP (Hardy-Pomeau-Pazzis) — это базовая модель решеточных газов (LGA), используемая для моделирования гидродинамических явлений на микроскопическом уровне. Она представляет собой дискретную систему, где пространство и время дискретизованы, а частицы двигаются по узлам квадратной решетки.&lt;/p&gt;
&lt;h3 id=&#34;основные-характеристики-модели-hpp&#34;&gt;Основные характеристики модели HPP:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Решетка&lt;/strong&gt;: используется двумерная квадратная решетка, где узлы расположены на одинаковом расстоянии друг от друга.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Частицы&lt;/strong&gt;: в каждом узле решетки могут находиться частицы единичной массы. Каждая частица может двигаться в одном из четырех направлений: вверх, вниз, вправо или влево.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Скорость&lt;/strong&gt;: все частицы имеют одинаковую скорость, направленную к соседнему узлу. Расстояние между узлами ($\Delta x$) и шаг времени ($\Delta t$) выбираются так, чтобы частица могла переместиться в соседний узел за один временной шаг.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Принцип исключения&lt;/strong&gt;: в каждом узле может находиться не более одной частицы, движущейся в заданном направлении.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Этапы эволюции&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Распространение (Streaming)&lt;/strong&gt;: частицы перемещаются в соседние узлы в соответствии со своими скоростями. За один шаг времени частица переходит в соседний узел в направлении своего движения.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Столкновения (Collision)&lt;/strong&gt;: в узлах происходят столкновения частиц, при которых сохраняются количество частиц и полный импульс.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Правила столкновений&lt;/strong&gt;: столкновения происходят таким образом, чтобы выполнялись законы сохранения. В модели HPP нетривиальные столкновения происходят, когда две частицы движутся навстречу друг другу (почти &amp;ldquo;лоб в лоб&amp;rdquo;). После столкновения частицы меняют направления движения на 90 градусов. Во всех остальных случаях столкновения считаются несущественными, и частицы продолжают двигаться в прежних направлениях.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Кодирование состояний&lt;/strong&gt;: состояние каждого узла решетки кодируется битами. Поскольку имеется четыре возможных направления движения, для кодирования состояния узла требуется четыре бита. Каждый бит соответствует одному из направлений: 0 — нет частицы, 1 — есть частица, движущаяся в этом направлении. Например, если частицы движутся вправо и вверх, состояние узла кодируется как &lt;code&gt;0101&lt;/code&gt; в двоичном формате.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Примеры перемещений частиц в модели HPP&#34; srcset=&#34;
               /media/2step/HppModelExamples_huef7440bf026680eb577c23db4d515b1c_10139_3f9b38726750b8d7932ecf5c868b04e4.webp 400w,
               /media/2step/HppModelExamples_huef7440bf026680eb577c23db4d515b1c_10139_ef65cad411fb84aa1bb4f206a36206b6.webp 760w,
               /media/2step/HppModelExamples_huef7440bf026680eb577c23db4d515b1c_10139_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;http://localhost:1313/media/2step/HppModelExamples_huef7440bf026680eb577c23db4d515b1c_10139_3f9b38726750b8d7932ecf5c868b04e4.webp&#34;
               width=&#34;440&#34;
               height=&#34;208&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h3 id=&#34;математическое-описание&#34;&gt;Математическое описание:&lt;/h3&gt;
&lt;p&gt;Обозначим возможные направления скорости как $d_1, d_2, d_3, d_4$$. Тогда:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;$d_1 = 0001_2 = 1$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$d_2 = 0010_2 = 2$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$d_3 = 0100_2 = 4$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$d_4 = 1000_2 = 8$&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Основные операции для работы с состояниями узлов:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Добавление частицы&lt;/strong&gt;: добавление к состоянию $S$ частицы с направлением скорости $d_k$:
$$
S \text{ OR } d_k \rightarrow S
$$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Проверка наличия частицы&lt;/strong&gt;: проверка, есть ли в состоянии $S$ частица с направлением скорости $d_k$:
$$
\text{if } (S \text{ AND } d_k) \neq 0
$$
Если результат не равен 0, то частица с направлением $d_k$ присутствует в узле.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;недостатки-модели-hpp&#34;&gt;Недостатки модели HPP:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Отсутствие симметрии&lt;/strong&gt;: квадратная решетка с четырьмя направлениями скорости недостаточно симметрична, что приводит к анизотропии в макроскопических свойствах.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Нефизичное поведение&lt;/strong&gt;: модель HPP неточно описывает гидродинамические свойства жидкостей и газов.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Для устранения этих недостатков были разработаны более совершенные модели, такие как FHP (Frisch-Hasslacher-Pomeau) на треугольных решетках и модели с добавлением покоящихся частиц.&lt;/p&gt;
&lt;h2 id=&#34;модель-fhp-i-frisch-hasslacher-pomeau&#34;&gt;Модель FHP-I (Frisch-Hasslacher-Pomeau)&lt;/h2&gt;
&lt;p&gt;Модель FHP-I (Frisch-Hasslacher-Pomeau) — это улучшенная модель решеточных газов (LGA), разработанная для устранения недостатков модели HPP, связанных с недостаточной симметрией. В модели FHP-I используется треугольная сетка и шесть направлений скорости.&lt;/p&gt;
&lt;h3 id=&#34;основные-характеристики-модели-fhp-i&#34;&gt;Основные характеристики модели FHP-I:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Решетка&lt;/strong&gt;: используется двумерная треугольная решетка, где каждый узел имеет шесть ближайших соседних узлов, расположенных под углами 60 градусов друг к другу.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Частицы&lt;/strong&gt;: в каждом узле решетки могут находиться частицы единичной массы. Каждая частица может двигаться в одном из шести направлений к соседним узлам.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Скорость&lt;/strong&gt;: все частицы имеют одинаковую скорость, направленную к соседнему узлу. Как и в модели HPP, расстояние между узлами и шаг времени выбираются так, чтобы частица могла переместиться в соседний узел за один временной шаг.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Принцип исключения&lt;/strong&gt;: в каждом узле может находиться не более одной частицы, движущейся в заданном направлении.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Этапы эволюции&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Распространение (Streaming)&lt;/strong&gt;: частицы перемещаются в соседние узлы в соответствии со своими скоростями.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Столкновения (Collision)&lt;/strong&gt;: в узлах происходят столкновения частиц, при которых сохраняются количество частиц и полный импульс.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Правила столкновений&lt;/strong&gt;: столкновения происходят таким образом, чтобы выполнялись законы сохранения. Важным аспектом модели FHP-I является наличие нескольких типов столкновений, обеспечивающих сохранение массы и импульса. Примеры столкновений:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Две частицы, движущиеся навстречу друг другу, могут изменить направление на 60 градусов.&lt;/li&gt;
&lt;li&gt;Три частицы, движущиеся по трем направлениям, могут изменить направления так, чтобы общий импульс остался неизменным.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Кодирование состояний&lt;/strong&gt;: состояние каждого узла решетки кодируется битами. Поскольку имеется шесть возможных направлений движения, для кодирования состояния узла требуется шесть битов. Каждый бит соответствует одному из направлений: 0 — нет частицы, 1 — есть частица, движущаяся в этом направлении.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;преимущества-модели-fhp-i&#34;&gt;Преимущества модели FHP-I:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Улучшенная симметрия&lt;/strong&gt;: треугольная решетка с шестью направлениями скорости обладает большей симметрией по сравнению с квадратной решеткой модели HPP. Это позволяет получить более точное описание гидродинамических свойств.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Реалистичное поведение&lt;/strong&gt;: модель FHP-I более точно описывает гидродинамические свойства жидкостей и газов по сравнению с моделью HPP.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;недостатки-модели-fhp-i&#34;&gt;Недостатки модели FHP-I:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Сложность реализации&lt;/strong&gt;: треугольная решетка и более сложные правила столкновений делают реализацию модели FHP-I более сложной по сравнению с моделью HPP.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;модель-fhp-iii&#34;&gt;Модель FHP-III&lt;/h2&gt;
&lt;p&gt;Модель FHP-III — это расширение модели FHP-I, предназначенное для улучшения её физических свойств за счет добавления покоящихся частиц. Введение покоящихся частиц позволяет более точно моделировать гидродинамические явления и улучшить изотропность модели.&lt;/p&gt;
&lt;h3 id=&#34;основные-характеристики-модели-fhp-iii&#34;&gt;Основные характеристики модели FHP-III:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Решетка&lt;/strong&gt;: используется двумерная треугольная решетка, как и в модели FHP-I. Каждый узел имеет шесть ближайших соседних узлов, расположенных под углами 60 градусов друг к другу.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Частицы&lt;/strong&gt;: в каждом узле решетки могут находиться частицы единичной массы. В отличие от FHP-I, в FHP-III добавлены покоящиеся частицы, которые не двигаются между узлами. Таким образом, у нас есть шесть движущихся частиц и покоящаяся частица.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Скорость&lt;/strong&gt;: шесть движущихся частиц имеют одинаковую скорость, направленную к соседнему узлу. Покоящиеся частицы имеют нулевую скорость.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Принцип исключения&lt;/strong&gt;: в каждом узле может находиться не более одной частицы, движущейся в заданном направлении, и не более одной покоящейся частицы.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Этапы эволюции&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Распространение (Streaming)&lt;/strong&gt;: движущиеся частицы перемещаются в соседние узлы в соответствии со своими скоростями. Покоящиеся частицы остаются на месте.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Столкновения (Collision)&lt;/strong&gt;: в узлах происходят столкновения частиц, при которых сохраняются количество частиц и полный импульс. В FHP-III добавляются новые правила столкновений, учитывающие покоящиеся частицы.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Правила столкновений&lt;/strong&gt;: столкновения происходят таким образом, чтобы выполнялись законы сохранения. Некоторые примеры столкновений:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Две частицы, движущиеся навстречу друг другу, могут изменить направление на 60 градусов (как в FHP-I).&lt;/li&gt;
&lt;li&gt;Частица может столкнуться с покоящейся частицей, изменив направление своего движения.&lt;/li&gt;
&lt;li&gt;Покоящаяся частица может быть создана или уничтожена в результате столкновений.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Кодирование состояний&lt;/strong&gt;: состояние каждого узла решетки кодируется битами. Поскольку имеется шесть возможных направлений движения и возможность наличия покоящейся частицы, для кодирования состояния узла требуется семь битов. Шесть битов соответствуют направлениям движения, а один бит — наличию покоящейся частицы.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;преимущества-модели-fhp-iii&#34;&gt;Преимущества модели FHP-III:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Улучшенная изотропность&lt;/strong&gt;: добавление покоящихся частиц улучшает изотропность модели, что позволяет получить более точное описание гидродинамических свойств.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Более реалистичное поведение&lt;/strong&gt;: модель FHP-III более точно описывает гидродинамические свойства жидкостей и газов по сравнению с моделями HPP и FHP-I.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;недостатки-модели-fhp-iii&#34;&gt;Недостатки модели FHP-III:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Сложность реализации&lt;/strong&gt;: добавление покоящихся частиц и новых правил столкновений делает реализацию модели FHP-III более сложной по сравнению с моделями HPP и FHP-I.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Решетка и некоторые возможные столкновения частиц в модели FHP-I(а), некоторые возможные столкновения с участием покоящихся частиц в модели FHP-III(б)&#34; srcset=&#34;
               /media/2step/2_hua8c1f89c1e830664a7c044501f27a78f_47013_fd102d41f5c133428a415476d3195483.webp 400w,
               /media/2step/2_hua8c1f89c1e830664a7c044501f27a78f_47013_cbed192c576ac0133db1d0895fce3afb.webp 760w,
               /media/2step/2_hua8c1f89c1e830664a7c044501f27a78f_47013_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;http://localhost:1313/media/2step/2_hua8c1f89c1e830664a7c044501f27a78f_47013_fd102d41f5c133428a415476d3195483.webp&#34;
               width=&#34;760&#34;
               height=&#34;502&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Модель с 9 направлениями скорости является модификацией модели решеточных газов, предназначенной для улучшения изотропности и введения понятия температуры в систему. Она использует квадратную сетку, но расширяет возможные направления движения частиц, позволяя им перемещаться не только по горизонтали и вертикали, но и по диагонали. Кроме того, вводится понятие покоящихся частиц.&lt;/p&gt;
&lt;h2 id=&#34;модель-с-9-направлениями-скорости&#34;&gt;Модель с 9 направлениями скорости&lt;/h2&gt;
&lt;h3 id=&#34;основные-характеристики-модели-с-9-направлениями-скорости&#34;&gt;Основные характеристики модели с 9 направлениями скорости:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Решетка&lt;/strong&gt;: используется двумерная квадратная решетка, как и в модели HPP.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Частицы&lt;/strong&gt;: в каждом узле решетки могут находиться частицы, движущиеся в одном из восьми направлений (вверх, вниз, вправо, влево, и по четырем диагоналям), а также покоящиеся частицы.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Скорость&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Частицы, движущиеся по горизонтали и вертикали, имеют скорость $v_1 = 1$.&lt;/li&gt;
&lt;li&gt;Частицы, движущиеся по диагонали, имеют скорость $v_2 = \sqrt{2}$.&lt;/li&gt;
&lt;li&gt;Покоящиеся частицы имеют нулевую скорость.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Направления движения&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;4 направления с единичной скоростью: вправо, влево, вверх, вниз.&lt;/li&gt;
&lt;li&gt;4 направления с диагональной скоростью: вправо-вверх, вправо-вниз, влево-вверх, влево-вниз.&lt;/li&gt;
&lt;li&gt;1 состояние покоя.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Возможные направления движения частиц в модели с девятью направлениями&#34; srcset=&#34;
               /media/2step/4_hude372aa6fd868089b4579ea4e484e33c_28657_04fa430e9a404d3f5d453fc43055c1fa.webp 400w,
               /media/2step/4_hude372aa6fd868089b4579ea4e484e33c_28657_652f939ce5e1e7ac70c99d4c043ce70c.webp 760w,
               /media/2step/4_hude372aa6fd868089b4579ea4e484e33c_28657_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;http://localhost:1313/media/2step/4_hude372aa6fd868089b4579ea4e484e33c_28657_04fa430e9a404d3f5d453fc43055c1fa.webp&#34;
               width=&#34;483&#34;
               height=&#34;482&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Этапы эволюции&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Распространение (Streaming)&lt;/strong&gt;: частицы перемещаются в соседние узлы в соответствии со своими скоростями.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Столкновения (Collision)&lt;/strong&gt;: в узлах происходят столкновения частиц, при которых сохраняются количество частиц, импульс и энергия.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Правила столкновений&lt;/strong&gt;: правила столкновений должны обеспечивать сохранение массы, импульса и энергии. Это достигается за счет более сложных правил столкновений по сравнению с моделями HPP и FHP.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Кодирование состояний&lt;/strong&gt;: состояние каждого узла решетки кодируется битами. Поскольку имеется 9 возможных состояний (8 направлений движения и состояние покоя), для кодирования состояния узла требуется 9 битов.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;физические-параметры&#34;&gt;Физические параметры:&lt;/h3&gt;
&lt;p&gt;В модели с 9 направлениями скорости можно определить макроскопические параметры, такие как плотность, полная энергия и температура.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Плотность&lt;/strong&gt; ($\rho$):
$$\rho = n_0 + n_1 + n_2$$&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;$n_0$ — число покоящихся частиц.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$n_1$ — число частиц с единичной скоростью.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$n_2$ — число частиц со скоростью $\sqrt{2}$.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Полная энергия&lt;/strong&gt; ($E$):
$$E = P + \frac{\rho u^2}{2} = \sum_i n_i \frac{v_i^2}{2} = \frac{n_1}{2} + n_2$$&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;$P$ — давление.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$u$ — макроскопическая скорость.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Температура&lt;/strong&gt; ($T$):
$T = \frac{P}{\rho}$&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;преимущества-модели-с-9-направлениями-скорости&#34;&gt;Преимущества модели с 9 направлениями скорости:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Изотропность&lt;/strong&gt;: добавление диагональных направлений движения улучшает изотропность модели по сравнению с моделью HPP.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Возможность введения температуры&lt;/strong&gt;: наличие различных скоростей позволяет ввести понятие температуры, что важно для моделирования тепловых процессов.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Более реалистичное поведение&lt;/strong&gt;: модель с 9 направлениями скорости более точно описывает гидродинамические свойства жидкостей и газов по сравнению с более простыми моделями.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;недостатки-модели-с-9-направлениями-скорости&#34;&gt;Недостатки модели с 9 направлениями скорости:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Сложность реализации&lt;/strong&gt;: добавление новых направлений движения и покоящихся частиц усложняет реализацию модели по сравнению с моделями HPP и FHP.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Вычислительные затраты&lt;/strong&gt;: большее число состояний и более сложные правила столкновений увеличивают вычислительные затраты.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;решеточное-уравнение-больцмана-lbe-lattice-boltzmann-equation&#34;&gt;Решеточное уравнение Больцмана (LBE, Lattice Boltzmann Equation)&lt;/h2&gt;
&lt;p&gt;Решеточное уравнение Больцмана (LBE) — это вычислительный метод, используемый для моделирования широкого спектра физических процессов, включая гидродинамику, фазовые переходы и химические реакции. LBE является более общим подходом по сравнению с моделями решеточных газов (LGA), такими как HPP, FHP-I и FHP-III, и предоставляет более точное и гибкое средство моделирования сложных систем.&lt;/p&gt;
&lt;h3 id=&#34;основные-характеристики-lbe&#34;&gt;Основные характеристики LBE:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Дискретизация пространства и времени&lt;/strong&gt;: LBE, как и LGA, дискретизует пространство и время. Пространство представляется в виде решетки (обычно квадратной или треугольной), а время разбивается на дискретные шаги.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Функция распределения&lt;/strong&gt;: в отличие от LGA, где отслеживаются отдельные частицы, LBE работает с функцией распределения $f_k(x, t)$, которая описывает вероятность нахождения частиц в узле $x$ в момент времени $t$, движущихся в направлении $k$.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Скорости&lt;/strong&gt;: частицы могут двигаться в нескольких дискретных направлениях $c_k$, определяемых геометрией решетки.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Основное уравнение&lt;/strong&gt;: эволюция системы описывается уравнением:&lt;/p&gt;
&lt;p&gt;$$
f_k(x + c_k \Delta t, t + \Delta t) = f_k(x, t) + \Omega_k(x, t)
$$&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;$f_k(x, t)$ — одночастичная функция распределения.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$c_k$ — скорость частиц.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\Omega_k(x, t)$ — столкновительный член, описывающий изменения функции распределения из-за столкновений частиц.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Столкновительный член&lt;/strong&gt;: описывает, как частицы взаимодействуют друг с другом. Наиболее часто используется модель BGK (Bhatnagar-Gross-Krook):&lt;/p&gt;
&lt;p&gt;$$
\Omega_k = \frac{1}{\tau}(f_k^{eq} - f_k)
$$&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;$\tau$ — время релаксации, характеризующее скорость приближения системы к равновесию.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$f_k^{eq}$ — равновесная функция распределения, описывающая состояние системы в равновесии.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Равновесная функция распределения&lt;/strong&gt;: обычно выбирается в виде разложения по полиномам Эрмита или в другом подходящем виде, чтобы обеспечить выполнение законов сохранения. Например, для модели D2Q9 (двумерная модель с 9 скоростями) равновесная функция распределения может быть записана как:&lt;/p&gt;
&lt;p&gt;$$
f_k^{eq} = w_k \rho \left[1 + \frac{c_k \cdot u}{c_s^2} + \frac{(c_k \cdot u)^2}{2c_s^4} - \frac{u^2}{2c_s^2}\right]
$$&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$w_k$ — весовые коэффициенты, зависящие от направления скорости.&lt;/li&gt;
&lt;li&gt;$\rho$ — плотность.&lt;/li&gt;
&lt;li&gt;$u$ — макроскопическая скорость.&lt;/li&gt;
&lt;li&gt;$c_s$ — скорость звука в решеточной модели.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Макроскопические параметры&lt;/strong&gt;: макроскопические параметры, такие как плотность и скорость, вычисляются через функции распределения:&lt;/p&gt;
&lt;p&gt;$$
\rho = \sum_k f_k
$$&lt;/p&gt;
&lt;p&gt;$$
\rho u = \sum_k f_k c_k
$$&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;преимущества-lbe&#34;&gt;Преимущества LBE:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Гибкость&lt;/strong&gt;: LBE может быть использован для моделирования широкого спектра физических явлений, включая гидродинамику, теплопередачу, фазовые переходы, химические реакции и многофазные потоки.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Эффективность&lt;/strong&gt;: LBE обладает хорошей параллелизуемостью, что позволяет эффективно использовать многопроцессорные системы для моделирования больших систем.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Точность&lt;/strong&gt;: LBE обеспечивает более точное описание гидродинамических свойств по сравнению с более простыми моделями LGA.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Простота реализации граничных условий&lt;/strong&gt;: LBE позволяет легко реализовывать сложные граничные условия.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;недостатки-lbe&#34;&gt;Недостатки LBE:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Ограничения по скорости&lt;/strong&gt;: LBE обычно работает хорошо для низкоскоростных течений. Для моделирования высокоскоростных течений требуются специальные модификации.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Вычислительные затраты&lt;/strong&gt;: LBE требует больше вычислительных ресурсов по сравнению с простыми моделями LGA.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;применение-lbe&#34;&gt;Применение LBE:&lt;/h3&gt;
&lt;p&gt;LBE находит широкое применение в различных областях науки и техники, включая:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Гидродинамика&lt;/strong&gt;: моделирование течений жидкостей и газов в сложных геометриях.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Аэродинамика&lt;/strong&gt;: моделирование обтекания тел потоками воздуха.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Пористые среды&lt;/strong&gt;: моделирование течений в пористых материалах.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Медицина&lt;/strong&gt;: моделирование кровотока в сосудах.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Химическая инженерия&lt;/strong&gt;: моделирование химических реакций в растворах.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Моделирование фазовых переходов&lt;/strong&gt;: моделирование процессов конденсации, испарения и кристаллизации.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Модель с взаимодействием между частицами используется для моделирования фазовых переходов и разделения фаз. В этой модели к обычным алгоритмам решеточных газов или решеточного уравнения Больцмана добавляются силы, действующие между частицами, находящимися в разных узлах решетки.&lt;/p&gt;
&lt;h2 id=&#34;модель-с-взаимодействием-между-частицами&#34;&gt;Модель с взаимодействием между частицами&lt;/h2&gt;
&lt;h3 id=&#34;основные-характеристики-модели-с-взаимодействием-между-частицами&#34;&gt;Основные характеристики модели с взаимодействием между частицами:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Взаимодействие между частицами&lt;/strong&gt;: для описания жидкостей и газов вводятся силы взаимодействия между частицами. Эти силы могут быть как отталкивающими (для моделирования разделения веществ), так и притягивающими (для моделирования фазовых переходов жидкость-газ).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Типы взаимодействий&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Отталкивание&lt;/strong&gt;: используется для моделирования разделения смеси веществ на компоненты. Частицы разных компонентов отталкиваются друг от друга, что приводит к их разделению.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Притяжение&lt;/strong&gt;: используется для моделирования фазовых переходов, таких как конденсация пара в жидкость или вскипание перегретой жидкости. Частицы притягиваются друг к другу, образуя кластеры или капли.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Влияние внешних сил&lt;/strong&gt;: внешние силы могут быть учтены через изменение скорости частиц:
$$
\Delta u = \frac{F \Delta t}{\rho}
$$&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$\Delta u$ — изменение скорости.&lt;/li&gt;
&lt;li&gt;$F$ — внешняя сила.&lt;/li&gt;
&lt;li&gt;$\Delta t$ — шаг времени.&lt;/li&gt;
&lt;li&gt;$\rho$ — плотность.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Уравнение Больцмана модифицируется добавкой:&lt;/p&gt;
&lt;p&gt;$$
f_k(x + c_k \Delta t, t + \Delta t) = f_k(x, t) + \Omega_k(x, t) + \Delta f_k
$$&lt;/p&gt;
&lt;p&gt;где:&lt;/p&gt;
&lt;p&gt;$$
\Delta f_k = f_k^{eq}(\rho, u + \Delta u) - f_k^{eq}(\rho, u)
$$&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$\Delta f_k$ — изменение функции распределения, вызванное внешней силой.&lt;/li&gt;
&lt;li&gt;$f_k^{eq}$ — равновесная функция распределения.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Моделирование фазовых переходов&lt;/strong&gt;: фазовые переходы моделируются через силы притяжения между соседними узлами:&lt;/p&gt;
&lt;p&gt;$$
F(x) = \psi(\rho(x)) \sum_{k} G_k e_k \psi(\rho(x + e_k))
$$&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$F(x)$ — сила, действующая на узел $x$.&lt;/li&gt;
&lt;li&gt;$\psi(\rho(x))$ — функция, зависящая от плотности в узле $x$.&lt;/li&gt;
&lt;li&gt;$G_k &amp;gt; 0$ — константа, определяющая силу притяжения.&lt;/li&gt;
&lt;li&gt;$e_k$ — вектор, указывающий направление к соседнему узлу.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;алгоритм-моделирования-с-взаимодействием&#34;&gt;Алгоритм моделирования с взаимодействием:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Инициализация&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Создание решетки (квадратной или треугольной).&lt;/li&gt;
&lt;li&gt;Установка начальных условий (плотность, скорость, температура).&lt;/li&gt;
&lt;li&gt;Определение параметров взаимодействия (сила притяжения или отталкивания).&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Распространение (Streaming)&lt;/strong&gt;: частицы перемещаются в соседние узлы в соответствии со своими скоростями.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Вычисление сил взаимодействия&lt;/strong&gt;: для каждого узла вычисляется сила, действующая на него со стороны соседних узлов.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Столкновения (Collision)&lt;/strong&gt;: в узлах происходят столкновения частиц, при которых сохраняются количество частиц, импульс и энергия. Учитывается влияние сил взаимодействия на изменение скоростей частиц.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Обновление скоростей&lt;/strong&gt;: скорости частиц изменяются под действием сил взаимодействия и внешних сил.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Повторение шагов 2-5&lt;/strong&gt;: процесс повторяется до достижения стационарного состояния или заданного времени моделирования.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;применение&#34;&gt;Применение:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Моделирование конденсации и испарения&lt;/strong&gt;: позволяет изучать процессы образования капель из пересыщенного пара и вскипания перегретой жидкости.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Разделение фаз (спинодальная декомпозиция)&lt;/strong&gt;: моделирование разделения смеси на фазы с разными свойствами.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Моделирование многофазных потоков&lt;/strong&gt;: изучение течений, в которых одновременно присутствуют несколько фаз (например, жидкость и газ).&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;модель-с-несколькими-компонентами-используется&#34;&gt;Модель с несколькими компонентами используется&lt;/h2&gt;
&lt;p&gt;Модель с несколькими компонентами используется для моделирования смесей веществ и химических реакций. В этой модели каждый компонент представлен своим набором частиц или функций распределения, и учитываются взаимодействия между различными компонентами.&lt;/p&gt;
&lt;h3 id=&#34;основные-характеристики-модели-с-несколькими-компонентами&#34;&gt;Основные характеристики модели с несколькими компонентами:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Несколько типов частиц&lt;/strong&gt;: в системе присутствует несколько видов частиц, каждый из которых соответствует определенному компоненту смеси.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Функции распределения для каждого компонента&lt;/strong&gt;: если используется подход LBE, то для каждого компонента определяется своя функция распределения $f_{k,i}(x, t)$, где $i$ — индекс компонента.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Взаимодействия между компонентами&lt;/strong&gt;: учитываются силы взаимодействия между различными компонентами смеси. Эти силы могут быть как отталкивающими (для моделирования разделения фаз), так и притягивающими (для моделирования образования соединений).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Химические реакции&lt;/strong&gt;: в модели могут быть реализованы химические реакции между компонентами. Для этого вводятся правила, определяющие, как и с какой вероятностью частицы разных компонентов могут превращаться друг в друга.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Уравнения эволюции&lt;/strong&gt;: эволюция системы описывается набором уравнений, учитывающих как гидродинамические процессы, так и химические реакции.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;алгоритм-моделирования-с-несколькими-компонентами&#34;&gt;Алгоритм моделирования с несколькими компонентами:&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Инициализация&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Создание решетки (квадратной или треугольной).&lt;/li&gt;
&lt;li&gt;Установка начальных условий (плотность, скорость, концентрация каждого компонента).&lt;/li&gt;
&lt;li&gt;Определение параметров взаимодействия между компонентами.&lt;/li&gt;
&lt;li&gt;Задание правил химических реакций (если они есть).&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Распространение (Streaming)&lt;/strong&gt;: частицы каждого компонента перемещаются в соседние узлы в соответствии со своими скоростями.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Вычисление сил взаимодействия&lt;/strong&gt;: для каждого узла вычисляются силы, действующие на частицы каждого компонента со стороны других компонентов.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Столкновения (Collision)&lt;/strong&gt;: в узлах происходят столкновения частиц, при которых сохраняются количество частиц, импульс и энергия для каждого компонента. Учитывается влияние сил взаимодействия на изменение скоростей частиц.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Химические реакции&lt;/strong&gt;: в узлах происходят химические реакции между компонентами в соответствии с заданными правилами. В результате этих реакций изменяется количество частиц каждого компонента.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Обновление скоростей&lt;/strong&gt;: скорости частиц каждого компонента изменяются под действием сил взаимодействия и внешних сил.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Повторение шагов 2-6&lt;/strong&gt;: процесс повторяется до достижения стационарного состояния или заданного времени моделирования.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;математическое-описание-1&#34;&gt;Математическое описание:&lt;/h3&gt;
&lt;p&gt;Для LBE с несколькими компонентами уравнение эволюции выглядит следующим образом:&lt;/p&gt;
&lt;p&gt;$$
f_{k,i}(x + c_k \Delta t, t + \Delta t) = f_{k,i}(x, t) + \Omega_{k,i}(x, t)
$$&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$f_{k,i}(x, t)$ — функция распределения для компонента $i$ в узле $x$ в момент времени $t$.&lt;/li&gt;
&lt;li&gt;$c_k$ — скорость частиц.&lt;/li&gt;
&lt;li&gt;$\Omega_{k,i}(x, t)$ — столкновительный член, описывающий изменения функции распределения из-за столкновений и химических реакций.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Столкновительный член может включать в себя как релаксацию к равновесию, так и члены, описывающие химические реакции:&lt;/p&gt;
&lt;p&gt;$$
\Omega_{k,i} = \Omega_{k,i}^{collision} + \Omega_{k,i}^{reaction}
$$&lt;/p&gt;
&lt;h3 id=&#34;применение-1&#34;&gt;Применение:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Моделирование смешивания жидкостей&lt;/strong&gt;: позволяет изучать процессы смешивания различных жидкостей и газов.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Разделение веществ&lt;/strong&gt;: моделирование разделения смеси на компоненты (например, разделение нефти на фракции).&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Моделирование химических реакций&lt;/strong&gt;: изучение кинетики химических реакций в растворах и газах.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Реакция-диффузия&lt;/strong&gt;: моделирование процессов, в которых химические реакции сочетаются с диффузией веществ.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;заключительная-часть&#34;&gt;Заключительная часть&lt;/h1&gt;
&lt;h2 id=&#34;заключение&#34;&gt;Заключение&lt;/h2&gt;
&lt;p&gt;Модели решеточных газов  $(LGA)$ и решеточное уравнение Больцмана $(LBE)$ представляют собой эффективные инструменты для моделирования газовых потоков, требующие меньше вычислительных ресурсов по сравнению с традиционными методами.&lt;/p&gt;
&lt;p&gt;Различные модели обладают разными характеристиками и применимы для разных задач. $HPP$ — простая базовая модель, $FHP-I$ и $FHP-III$ улучшают симметрию и изотропность, а модель с 9 направлениями скорости позволяет вводить понятие температуры. $LBE$ является наиболее общим и гибким подходом.&lt;/p&gt;
&lt;p&gt;Выбор конкретного алгоритма зависит от требований к точности, вычислительным ресурсам и специфике решаемой задачи.&lt;/p&gt;
&lt;h2 id=&#34;выводы&#34;&gt;Выводы&lt;/h2&gt;
&lt;p&gt;Во время выполнения второго этапа группового проекта мы сделали теоретическое описание алгоитмов, которые могут быть использованы для моделирования решеточного уравнения Больцмана.&lt;/p&gt;
&lt;h1 id=&#34;список-литературы&#34;&gt;Список литературы&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Медведев Д.А. и др. Моделирование физических процессов и явлений на ПК: Учеб. пособие. // Новосибирск: Новосиб. гос. ун-т, 2010. 101 с.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Куперштох А. Л. Моделирование течений с границами раздела жидкость-пар методом решеточных уравнениях Больцмана //
Вестник НГУ. Сер. Математика, механика и информатика. 2005. Т. 5, № 3. с. 29–42.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Chen S., Lee M., Zhao K. H., Doolen G. D. A lattice gas model with temperature // Physica D. 1989. V. 37. p. 42–59.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://doi.org/10.20948/prepr-2021-99&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Чащин Г.С. Метод решёточных уравнений Больцмана: моделирование изотермических низкоскоростных течений&lt;/a&gt; // &lt;a href=&#34;https://library.keldysh.ru/preprint.asp?id=2021-99&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Препринты ИПМ им. М.В.Келдыша. 2021. № 99. 31 с.&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Frisch, Uriel, Brosl Hasslacher, and Yves Pomeau. &amp;ldquo;Lattice Gas Automata for the Navier-Stokes Equation.&amp;rdquo; Phys. Rev. Lett. 56, no. 14 (1986): 1505-1508.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Succi, Sauro. The Lattice Boltzmann Equation for Fluid Dynamics and Beyond. Oxford University Press, 2001.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    
    <item>
      <title>Первый этап проекта</title>
      <link>http://localhost:1313/publication/1step/</link>
      <pubDate>Sat, 22 Mar 2025 00:00:00 +0000</pubDate>
      <guid>http://localhost:1313/publication/1step/</guid>
      <description>&lt;h1 id=&#34;введение&#34;&gt;Введение&lt;/h1&gt;
&lt;h2 id=&#34;цель-проекта&#34;&gt;Цель проекта&lt;/h2&gt;
&lt;p&gt;Разработать и проанализировать модель на основе решеточного уравнения Больцмана для описания течений газа.&lt;/p&gt;
&lt;h2 id=&#34;задачи-первого-этапа-проекта&#34;&gt;Задачи первого этапа проекта&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Формулировка научной проблемы&lt;/strong&gt;: определение ключевых аспектов проблемы и ее значимости.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Теоретическое описание задачи&lt;/strong&gt;: формулировка теоретических основ модели.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Описание модели&lt;/strong&gt;: разработка математической модели, отражающей основные физические процессы.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;объект-и-предмет-исследования&#34;&gt;Объект и предмет исследования&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Объект:&lt;/strong&gt; физические процессы в газах и жидкостях.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Предмет:&lt;/strong&gt; использование решеточных методов (LGA и LBE) для описания динамики частиц на дискретной сетке.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;постановка-проблемы&#34;&gt;Постановка проблемы&lt;/h2&gt;
&lt;p&gt;Моделирование газовых потоков и жидкостей традиционными методами, такими как уравнения Навье-Стокса и методы конечных разностей, требует значительных вычислительных ресурсов и сложных алгоритмов. Методы решеточных газов (Lattice-Gas Automata, LGA) и решеточного уравнения Больцмана (Lattice Boltzmann Equation, LBE) предлагают альтернативу, позволяя упростить вычисления при сохранении физической достоверности. Эти методы широко используются в различных областях:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Гидродинамика&lt;/strong&gt;: моделирование течений жидкостей и газов.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Аэродинамика&lt;/strong&gt;: изучение воздушных потоков и аэродинамических свойств объектов.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Биофизика&lt;/strong&gt;: моделирование биологических систем и процессов.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Моделирование пористых материалов&lt;/strong&gt;: изучение свойств и поведения пористых сред.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Анимация визуальных эффектов&lt;/strong&gt;: создание реалистичных симуляций жидкостей и газов в кино и играх.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Применение методов актуально для:&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Исследования сложных многокомпонентных течений&lt;/strong&gt;: моделирование взаимодействия нескольких жидкостей или газов.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Течений с фазовыми переходами и химическими реакциями&lt;/strong&gt;: изучение процессов, связанных с изменением состояния вещества или химическими реакциями.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Создания высокопроизводительных параллельных алгоритмов&lt;/strong&gt;: разработка эффективных вычислительных методов для крупномасштабных симуляций.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;научная-значимость&#34;&gt;Научная значимость&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Моделирование сложных систем&lt;/strong&gt;: решеточные методы позволяют описывать взаимодействие частиц и фазовые переходы, что важно для понимания поведения реальных систем.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Высокая скорость вычислений&lt;/strong&gt;: дискретная природа моделей упрощает распараллеливание и ускоряет вычисления.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Простота реализации&lt;/strong&gt;: алгоритмы не требуют сложных вычислительных схем, что делает их доступными для широкого круга исследователей и инженеров.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;общее-описание&#34;&gt;Общее описание&lt;/h2&gt;
&lt;p&gt;В отчете рассматриваются методы моделирования гидродинамических процессов на основе решеточных моделей: Lattice-Gas Automata (LGA) и Lattice Boltzmann Equation (LBE). Эти методы позволяют упростить вычисления и моделировать сложные явления, такие как течения жидкостей и газов, теплопередача и фазовые переходы.&lt;/p&gt;
&lt;h1 id=&#34;основная-часть&#34;&gt;Основная часть&lt;/h1&gt;
&lt;h2 id=&#34;решеточные-газы-lga&#34;&gt;Решеточные газы (LGA)&lt;/h2&gt;
&lt;h3 id=&#34;общее-описание-1&#34;&gt;Общее описание&lt;/h3&gt;
&lt;p&gt;Рассматривается квадратная решетка, в узлах которой находятся частицы единичной массы. Расстояние между узлами $\Delta x$ и шаг по времени $\Delta t$ принимаются за единицу длины и времени соответственно. В каждом узле может быть не более одной частицы с данным направлением скорости (принцип исключения).&lt;/p&gt;
&lt;h4 id=&#34;модель-hpp-hardypomeaupazzis&#34;&gt;Модель HPP (Hardy–Pomeau–Pazzis)&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Описание&lt;/strong&gt;:
&lt;ul&gt;
&lt;li&gt;Используется квадратная решетка.&lt;/li&gt;
&lt;li&gt;Частицы могут двигаться в одном из соседних узлов (вверх, вниз, вправо, влево).&lt;/li&gt;
&lt;li&gt;Соударения происходят с сохранением количества частиц и их полного импульса.&lt;/li&gt;
&lt;li&gt;Нетривиальными являются соударения &amp;ldquo;почти лоб в лоб&amp;rdquo;, после которых скорости частиц поворачиваются на 90 градусов. В остальных случаях можно считать, что столкновения не произошло (частицы пролетели мимо друг друга).
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Пояснение&lt;/em&gt;: Столкновения &amp;ldquo;почти лоб в лоб&amp;rdquo; — это когда частицы летят навстречу друг другу по одной линии, а после столкновения их траектории отклоняются на 90 градусов.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-возможные-направления-скорости-частиц-в-модели-hpp-а-и-возможные-столкновения-в-которых-скорости-частиц-изменяются-б&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Возможные направления скорости частиц в модели HPP (а) и возможные столкновения, в которых скорости частиц изменяются (б)&#34; srcset=&#34;
               /media/rep11_hu1bb12afd743f2417b769348c47783fe1_35160_e26ea38675908a750aa08ca1aa347aae.webp 400w,
               /media/rep11_hu1bb12afd743f2417b769348c47783fe1_35160_b540d97700697823a39170ea0d187119.webp 760w,
               /media/rep11_hu1bb12afd743f2417b769348c47783fe1_35160_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;http://localhost:1313/media/rep11_hu1bb12afd743f2417b769348c47783fe1_35160_e26ea38675908a750aa08ca1aa347aae.webp&#34;
               width=&#34;760&#34;
               height=&#34;237&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Возможные направления скорости частиц в модели HPP (а) и возможные столкновения, в которых скорости частиц изменяются (б)
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Кодирование состояний&lt;/strong&gt;:
&lt;ul&gt;
&lt;li&gt;Наличие частицы, имеющей скорость по каждому направлению, может быть закодировано одним битом (0 — нет частицы, 1 — есть).&lt;/li&gt;
&lt;li&gt;Так можно записать состояние каждого узла в четырех битах.&lt;/li&gt;
&lt;li&gt;Примеры операций:
&lt;ul&gt;
&lt;li&gt;Добавление к состоянию S частицы с направлением скорости $d_k$:
$S \text{ or } d_k \rightarrow S$&lt;/li&gt;
&lt;li&gt;Проверка: есть ли в состоянии S частица с направлением скорости $d_k$:
$\text{if } (S \text{ and } d_k) \neq 0$&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Здесь &lt;code&gt;or&lt;/code&gt; — двоичная побитовая операция &amp;ldquo;или&amp;rdquo;, а &lt;code&gt;and&lt;/code&gt; — двоичная операция &amp;ldquo;и&amp;rdquo;.
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Пояснение&lt;/em&gt;: Операции &lt;code&gt;or&lt;/code&gt; и &lt;code&gt;and&lt;/code&gt; используются для манипулирования битами, что позволяет эффективно кодировать и обрабатывать состояния частиц.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Все операции сводятся к целочисленной арифметике, это означает высокую скорость расчетов и отсутствие ошибок округления. Кроме того, все вычисления локальные, поэтому их можно выполнять параллельно.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Недостатки&lt;/strong&gt;:
&lt;ul&gt;
&lt;li&gt;Квадратная сетка с 4 возможными направлениями скорости частиц недостаточно симметрична.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;модель-fhp-i&#34;&gt;Модель FHP-I&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Описание&lt;/strong&gt;:
&lt;ul&gt;
&lt;li&gt;Используется треугольная сетка с 6 возможными направлениями скорости частиц в узле.&lt;/li&gt;
&lt;li&gt;Обладает большей симметрией по сравнению с моделью HPP.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;модель-fhp-iii&#34;&gt;Модель FHP-III&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Описание&lt;/strong&gt;:
&lt;ul&gt;
&lt;li&gt;Включает в себя покоящиеся частицы.&lt;/li&gt;
&lt;li&gt;Геометрия решетки и возможные столкновения частиц для моделей FHP-I, FHP-III представлены ниже:&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-решетка-и-некоторые-возможные-столкновения-частиц-в-модели-fhp-iа-некоторые-возможные-столкновения-с-участием-покоящихся-частиц-в-модели-fhp-iiiб&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Решетка и некоторые возможные столкновения частиц в модели FHP-I(а), некоторые возможные столкновения с участием покоящихся частиц в модели FHP-III(б)&#34; srcset=&#34;
               /media/rep12_hub361a8f41f999bd0cd25d41d6c5cda25_81783_b952fc88e098158f61f19ab00711152f.webp 400w,
               /media/rep12_hub361a8f41f999bd0cd25d41d6c5cda25_81783_fa69e1dd96c043d6b367869d9ca62bbe.webp 760w,
               /media/rep12_hub361a8f41f999bd0cd25d41d6c5cda25_81783_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;http://localhost:1313/media/rep12_hub361a8f41f999bd0cd25d41d6c5cda25_81783_b952fc88e098158f61f19ab00711152f.webp&#34;
               width=&#34;760&#34;
               height=&#34;499&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Решетка и некоторые возможные столкновения частиц в модели FHP-I(а), некоторые возможные столкновения с участием покоящихся частиц в модели FHP-III(б)
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h4 id=&#34;квадратная-решетка-с-движением-по-диагоналям&#34;&gt;Квадратная решетка с движением по диагоналям&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Описание&lt;/strong&gt;:
&lt;ul&gt;
&lt;li&gt;Вводится возможность движения частиц по диагоналям (скорость $\sqrt{2}$).&lt;/li&gt;
&lt;li&gt;Вместе с покоящимися частицами получаем 9 направлений скорости.&lt;/li&gt;
&lt;li&gt;Так как модули скоростей различны, возможен нетривиальный закон сохранения энергии, и можно ввести температуру.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Параметры&lt;/strong&gt;:
&lt;ul&gt;
&lt;li&gt;Число покоящихся частиц: $n_0$&lt;/li&gt;
&lt;li&gt;Число частиц с единичной скоростью: $n_1$&lt;/li&gt;
&lt;li&gt;Число частиц со скоростью $\sqrt{2}$: $n_2$&lt;/li&gt;
&lt;li&gt;Плотность: $\rho = n_0 + n_1 + n_2$&lt;/li&gt;
&lt;li&gt;Полная энергия: $E = P + \frac{\rho u^2}{2} = \sum_i n_i v_i^2 / 2 = n_1/2 + n_2$ (где $P$ — давление)&lt;/li&gt;
&lt;li&gt;Температура: $T = \frac{P}{\rho}$&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Возможности&lt;/strong&gt;:
&lt;ul&gt;
&lt;li&gt;Моделирование течений с переменной температурой.&lt;/li&gt;
&lt;li&gt;Моделирование теплопередачи и выделения энергии.&lt;/li&gt;
&lt;li&gt;Легко задавать граничные условия любого вида (например, разворачивать скорости прилетевших частиц на угол 180 градусов на твердых границах).
Несколько примеров столкновений, в том числе с выделением энергии, приведены ниже:&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-геометрия-и-примеры-столкновений-для-квадратной-решетки&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Геометрия и примеры столкновений для квадратной решетки&#34; srcset=&#34;
               /media/rep13_hu496c82bf27b2efd18ca55c6ea7edf215_15615_8127645c2e229ffbfac4045f0839b52a.webp 400w,
               /media/rep13_hu496c82bf27b2efd18ca55c6ea7edf215_15615_54f6b0a2e7a425731c430b0d207e326a.webp 760w,
               /media/rep13_hu496c82bf27b2efd18ca55c6ea7edf215_15615_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;http://localhost:1313/media/rep13_hu496c82bf27b2efd18ca55c6ea7edf215_15615_8127645c2e229ffbfac4045f0839b52a.webp&#34;
               width=&#34;489&#34;
               height=&#34;260&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Геометрия и примеры столкновений для квадратной решетки
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;решеточное-уравнение-больцмана-lbe&#34;&gt;Решеточное уравнение Больцмана (LBE)&lt;/h2&gt;
&lt;h3 id=&#34;общее-описание-2&#34;&gt;Общее описание&lt;/h3&gt;
&lt;p&gt;Метод LBE позволяет устранить статистический шум, возникающий из-за случайности в модели LGA. Эволюция системы описывается уравнением Больцмана:&lt;/p&gt;
&lt;p&gt;$f_k(x + c_k \Delta t, t + \Delta t) = f_k(x, t) + \Omega_k(x, t)$, где:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;$f_k$ — одночастичная функция распределения.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$c_k$ — скорость частиц.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\Omega_k$ — столкновительный член.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Пояснение&lt;/em&gt;: Это уравнение описывает, как меняется распределение частиц со временем и в пространстве. Левая часть описывает перенос частиц, а правая — изменения из-за столкновений.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Условие&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Скорости частиц $c_k$ должны удовлетворять условию $c_k \Delta t = e_k$, где $e_k$ — векторы, соединяющие узел с соседними. Обычно принимается $\Delta t = 1$.
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Пояснение&lt;/em&gt;: Это условие гарантирует, что частицы перемещаются из одного узла в другой за один временной шаг.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Макроскопические параметры&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Плотность: $\rho = \sum_k f_k$&lt;/li&gt;
&lt;li&gt;Скорость: $\rho u = \sum_k f_k c_k$
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Пояснение&lt;/em&gt;: Эти формулы позволяют связать микроскопические параметры (функцию распределения) с макроскопическими (плотность и скорость).&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Столкновительный член&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Описывает релаксацию системы к равновесному состоянию:
$\Omega_k = \frac{1}{\tau} (f_k^{eq} - f_k)$, где $f_k^{eq}$ — равновесные функции распределения.&lt;/li&gt;
&lt;li&gt;Равновесные функции распределения зависят от плотности и скорости вещества в узле, чтобы выполнялись законы сохранения массы и импульса в столкновениях, то есть
$\rho = \sum_k f_k^{eq}, \quad \rho u = \sum_k f_k^{eq} c_k$.
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Пояснение&lt;/em&gt;: Столкновительный член моделирует, как частицы стремятся к равновесному состоянию, а равновесные функции распределения определяют это состояние.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Кинетическая температура&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;$\theta = \frac{kT}{m}$ (в энергетических единицах) задается уравнением
$\rho \theta = \sum_k f_k^{eq} (c_k - u)^2 / 2$.
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Пояснение&lt;/em&gt;: Кинетическая температура характеризует среднюю кинетическую энергию частиц.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Часто масса LBE частиц принимается за единицу, $m = 1$.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Преимущества&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Хорошо описывает течения вязкой жидкости в пределе малых скоростей (число Маха $M = u / c_s \ll 1$).
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Пояснение&lt;/em&gt;: Число Маха — отношение скорости потока к скорости звука.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Время релаксации $\tau$ определяет кинематическую вязкость $\nu = (\tau - 1/2) c_s^2 \Delta t$.&lt;/li&gt;
&lt;li&gt;На твердых границах можно просто разворачивать скорости прилетевших частиц, моделируя непроницаемые стенки без проскальзывания.
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Пояснение&lt;/em&gt;: Граничные условия задаются простым отражением скорости, что упрощает моделирование.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;приложение-явный-вид-функций-f_keq&#34;&gt;Приложение. Явный вид функций $f_k^{eq}$&lt;/h3&gt;
&lt;p&gt;Обычно равновесные функции распределения выбираются в максвелловском виде:&lt;/p&gt;
&lt;p&gt;$f_k^{eq} \sim \exp(-(c_k - u)^2 / 2\theta)$.&lt;/p&gt;
&lt;p&gt;В изотермических моделях достаточно разложить экспоненту в ряд с точностью до членов порядка $u^2$, используя приближенную формулу $e^x = 1 + x/1! + x^2/2! + &amp;hellip;$. В результате получаем:&lt;/p&gt;
&lt;p&gt;$f_k^{eq} = w_k \rho \left( 1 + \frac{c_k \cdot u}{\theta} + \frac{(c_k \cdot u)^2}{2\theta^2} - \frac{u^2}{2\theta} \right)$.&lt;/p&gt;
&lt;p&gt;Коэффициенты $w_k \sim \exp(-c_k^2 / 2\theta)$ зависят только от модуля $|c_k|$.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Примеры&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Одномерная модель&lt;/strong&gt;:
&lt;ul&gt;
&lt;li&gt;$c_0 = 0, \quad c_{-1} = -h / \Delta t, \quad c_1 = h / \Delta t$&lt;/li&gt;
&lt;li&gt;$\theta = \frac{1}{3} (h / \Delta t)^2, \quad w_0 = \frac{2}{3}, \quad w_{\pm 1} = \frac{1}{6}$&lt;/li&gt;
&lt;li&gt;$f_0^{eq} = \frac{2}{3} \rho (1 - \frac{3}{2} \tilde{u}^2), \quad f_{\pm 1}^{eq} = \frac{1}{6} \rho (1 \pm 3\tilde{u} + 3\tilde{u}^2)$&lt;/li&gt;
&lt;li&gt;Здесь $\tilde{u} = u \Delta t / h$ — безразмерная скорость вещества.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Двумерная модель на квадратной сетке с 9 направлениями&lt;/strong&gt;:
&lt;ul&gt;
&lt;li&gt;$c_0 = (0, 0)$&lt;/li&gt;
&lt;li&gt;$c_k = \frac{h}{\Delta t} (\cos(k \pi / 2), \sin(k \pi / 2))$ для $k = 1 \dots 4$&lt;/li&gt;
&lt;li&gt;$c_k = \frac{\sqrt{2} h}{\Delta t} (\cos((k + 1/2) \pi / 2), \sin((k + 1/2) \pi / 2))$ для $k = 5 \dots 8$&lt;/li&gt;
&lt;li&gt;$\theta = \frac{1}{3} (h / \Delta t)^2, \quad w_0 = \frac{4}{9}, \quad w_{1-4} = \frac{1}{9}, \quad w_{5-8} = \frac{1}{36}$&lt;/li&gt;
&lt;li&gt;$f_0^{eq} = w_0 \rho (1 - d \tilde{u}^2)$&lt;/li&gt;
&lt;li&gt;$f_1^{eq} = w_1 \rho (1 + a \tilde{u}_x + b \tilde{u}_x^2 - d \tilde{u}^2)$&lt;/li&gt;
&lt;li&gt;&amp;hellip;&lt;/li&gt;
&lt;li&gt;$f_8^{eq} = w_8 \rho (1 + a (\tilde{u}_x - \tilde{u}_y) + b (\tilde{u}_x - \tilde{u}_y)^2 - d \tilde{u}^2)$&lt;/li&gt;
&lt;li&gt;где $a = \frac{(\Delta t / h)^2}{\theta} = 3, \quad b = \frac{(\Delta t / h)^4}{2 \theta^2} = \frac{9}{2}, \quad d = \frac{(\Delta t / h)^2}{2 \theta} = \frac{3}{2}$&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Далее для простоты будем опускать значок «~» у переменной $u$.&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-геометрия-решетки-и-возможные-векторы-скорости&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Геометрия решетки и возможные векторы скорости&#34; srcset=&#34;
               /media/rep14_huc6a055296ab313b98100e58709cfe033_17423_ef2335a6c3c415823a2dd745bd6384ce.webp 400w,
               /media/rep14_huc6a055296ab313b98100e58709cfe033_17423_fb15932a3d82f8702bcb51b36354feb2.webp 760w,
               /media/rep14_huc6a055296ab313b98100e58709cfe033_17423_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;http://localhost:1313/media/rep14_huc6a055296ab313b98100e58709cfe033_17423_ef2335a6c3c415823a2dd745bd6384ce.webp&#34;
               width=&#34;343&#34;
               height=&#34;344&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Геометрия решетки и возможные векторы скорости
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;модели-lga-со-взаимодействием-между-частицами&#34;&gt;Модели LGA со взаимодействием между частицами&lt;/h2&gt;
&lt;h3 id=&#34;общее-описание-3&#34;&gt;Общее описание&lt;/h3&gt;
&lt;p&gt;Приведенные выше модели описывают скорее газ, чем жидкость. В жидкости между частицами существуют силы взаимодействия, проявлением которых являются поверхностное натяжение, а также фазовые переходы жидкость-газ.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Несмешивающиеся решеточные газы&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;Вводится отталкивание между частицами разного типа (например, &amp;ldquo;синими&amp;rdquo; и &amp;ldquo;красными&amp;rdquo;).&lt;/li&gt;
&lt;li&gt;При достаточной силе отталкивания происходит разделение веществ.&lt;/li&gt;
&lt;li&gt;Это достигается перераспределением цвета частиц после столкновений так, чтобы красные частицы в основном направлялись в узлы с преобладанием красного цвета и наоборот.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Модель LGA с переходом &amp;ldquo;жидкость-газ&amp;rdquo;&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;Вводится притяжение между частицами, находящимися на некотором расстоянии.&lt;/li&gt;
&lt;li&gt;Импульсы частиц поворачиваются друг к другу, если это возможно, с учетом закона сохранения импульса согласно третьему закону Ньютона.&lt;/li&gt;
&lt;li&gt;При достаточно большой длине взаимодействия в некотором диапазоне плотностей возможно сосуществование плотной (жидкой) и разреженной (газообразной) фаз.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;модель-lbe-с-внешними-силами-и-фазовыми-переходами&#34;&gt;Модель LBE с внешними силами и фазовыми переходами&lt;/h2&gt;
&lt;h3 id=&#34;действие-внешних-сил&#34;&gt;Действие внешних сил&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Моделирование сил, действующих на вещество&lt;/strong&gt;.
&lt;ul&gt;
&lt;li&gt;Природа сил может быть самой разной (например, электрические силы, сила тяжести, силы межмолекулярного взаимодействия и т.д.).&lt;/li&gt;
&lt;li&gt;Суммарная сила, действующая на вещество в узле, равна $F$.&lt;/li&gt;
&lt;li&gt;Действие силы в течение шага по времени $\Delta t$ приводит к изменению скорости:
$\Delta u = \frac{F \Delta t}{\rho}$.&lt;/li&gt;
&lt;li&gt;Решеточное уравнение Больцмана принимает вид:
$f_k(x + c_k \Delta t, t + \Delta t) = f_k(x, t) + \Omega_k(x, t) + \Delta f_k$.
То есть, после действия оператора столкновений (в котором используется скорость $u$), необходимо учесть изменение функций распределения $\Delta f_k$ под действием сил. Эта добавка равна разнице равновесных функций распределения при одной и той же плотности, но с разными скоростями:
$\Delta f_k = f_k^{eq} (\rho, u + \Delta u) - f_k^{eq} (\rho, u)$.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Порядок учета действия сил&lt;/strong&gt;:
&lt;ol&gt;
&lt;li&gt;Вычислить промежуточные значения функций распределения:
$f^*_k(x, t + \Delta t) = f_k(x, t) + \Delta f_k$.&lt;/li&gt;
&lt;li&gt;Применить оператор столкновений:
$f_k(x, t + \Delta t) = f^&lt;em&gt;_k(x, t + \Delta t) + (f^{eq}_k (u + \Delta u) - f^&lt;/em&gt;_k(x, t + \Delta t)) / \tau$.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Физическая скорость вещества&lt;/strong&gt;:
&lt;ul&gt;
&lt;li&gt;$u^* = \frac{u + (u + \Delta u)}{2} = u + \frac{\Delta u}{2}$.
&lt;ul&gt;
&lt;li&gt;На каждом шаге по времени в каждом узле существуют два значения скорости — до и после действия сил.&lt;/li&gt;
&lt;li&gt;В случае действия сил физическая скорость вещества равна их среднему арифметическому.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;фазовые-переходы&#34;&gt;Фазовые переходы&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Достаточно простой способ моделирования фазовых переходов жидкость – пар.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Между частицами, находящимися в соседних узлах, задается сила взаимодействия:&lt;/p&gt;
&lt;p&gt;$F(x) = \psi(\rho(x)) \sum_k G_k e_k \psi(\rho(x + e_k))$.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Значения коэффициентов $G_k &amp;gt; 0$ соответствуют притяжению между соседними узлами, что необходимо для сосуществования жидкой фазы и паровой фазы. В обратном случае при $G_k &amp;lt; 0$ — отталкивание.&lt;/li&gt;
&lt;li&gt;$G_k$ выбираются таким образом, чтобы сила была достаточно изотропной (чтобы, например, капли получались круглыми).&lt;/li&gt;
&lt;li&gt;При использовании модели LBE на квадратной сетке сила взаимодействия между узлами, расположенными по диагонали на расстоянии $\sqrt{2}$, должна быть в 4 раза меньше, чем между ближайшими соседями, то есть $G_{1-4} = G_0 &amp;gt; 0$, а $G_{5-8} = \frac{G_0}{4}$.&lt;/li&gt;
&lt;li&gt;«Эффективная плотность» $\psi(\rho)$ может выбираться достаточно произвольно.&lt;/li&gt;
&lt;li&gt;Введение такого взаимодействия приводит к уравнению состояния, которое связывает давление, плотность и температуру.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;заключительная-часть&#34;&gt;Заключительная часть&lt;/h1&gt;
&lt;h2 id=&#34;заключение&#34;&gt;Заключение&lt;/h2&gt;
&lt;p&gt;Методы решеточных газов и решеточного уравнения Больцмана предоставляют мощный инструмент для моделирования сложных физических процессов, включая гидродинамику, теплопередачу и фазовые переходы. Их простота и возможность параллельных вычислений делают их перспективными для изучения широкого класса задач в физике и инженерии. Модели LGA позволяют упростить расчеты и учитывать сложные взаимодействия между частицами, а метод LBE позволяет устранить статистический шум и моделировать макроскопические параметры вещества.&lt;/p&gt;
&lt;h2 id=&#34;выводы&#34;&gt;Выводы&lt;/h2&gt;
&lt;p&gt;Во время выполнения первого этапа группового проекта мы сделали теоретическое описание решеточного уравнения Больцмана и определили задачи дальнейшего исследования.&lt;/p&gt;
&lt;h1 id=&#34;список-литературы&#34;&gt;Список литературы&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Медведев Д.А. и др. Моделирование физических процессов и явлений на ПК: Учеб. пособие. // Новосибирск: Новосиб. гос. ун-т, 2010. 101 с.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Куперштох А. Л. Моделирование течений с границами раздела жидкость-пар методом решеточных уравнениях Больцмана //
Вестник НГУ. Сер. Математика, механика и информатика. 2005. Т. 5, № 3. с. 29–42.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Chen S., Lee M., Zhao K. H., Doolen G. D. A lattice gas model with temperature // Physica D. 1989. V. 37. p. 42–59.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://doi.org/10.20948/prepr-2021-99&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Чащин Г.С. Метод решёточных уравнений Больцмана: моделирование изотермических низкоскоростных течений&lt;/a&gt; // &lt;a href=&#34;https://library.keldysh.ru/preprint.asp?id=2021-99&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Препринты ИПМ им. М.В.Келдыша. 2021. № 99. 31 с.&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    
  </channel>
</rss>
